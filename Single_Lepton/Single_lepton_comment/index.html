
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Search for dark matter produced in association with a single top quark or a top quark pair in proton-proton collisions at √s = 13 TeV">
      
      
      
        <link rel="canonical" href="https://cms-epn.github.io/search-for-dark-matter-docs/Single_Lepton/Single_lepton_comment/">
      
      
        <link rel="prev" href="../../All_Hadronic/all%20hadronic%20si/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Single Lepton - Search for dark matter</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Merriweather Sans";--md-code-font:"Red Hat Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="blue-grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#single-lepton" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Search for dark matter" class="md-header__button md-logo" aria-label="Search for dark matter" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Search for dark matter
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Single Lepton
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="blue-grey"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CMS-EPN/search-for-dark-matter-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    search-for-dark-matter-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Search for dark matter" class="md-nav__button md-logo" aria-label="Search for dark matter" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    Search for dark matter
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CMS-EPN/search-for-dark-matter-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    search-for-dark-matter-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EPN CMS collaboration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    All Hadronic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            All Hadronic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../All_Hadronic/all%20hadronic%20si/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    All hadronic chanel
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Single Lepton
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Single Lepton
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Single Lepton
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Single Lepton
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#physics-motivation-and-channel-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Physics Motivation and Channel Strategy
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#physics-motivation-and-channel-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Physics Motivation and Channel Strategy
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="single-lepton">Single Lepton</h1>
<h2 id="physics-motivation-and-channel-strategy">Physics Motivation and Channel Strategy</h2>
<p>The Large Hadron Collider (LHC) collides protons at center-of-mass energies high enough to probe physics beyond the Standard Model. Although the protons are composite objects, the relevant hard scatterings occur between their constituents — quarks and gluons. In the context of simplified dark matter models, these partonic interactions can produce <strong>top quarks</strong> together with a new mediator particle (commonly denoted φ for scalar or a for pseudoscalar). The mediator then decays invisibly into a pair of dark matter candidates (<span class="arithmatex">\(\chi \bar{\chi}\)</span>). At the detector level, this results in events with multiple top quarks plus significant <strong>missing transverse momentum</strong> (<span class="arithmatex">\(p_T^{\text{miss}}\)</span>), the latter coming from both neutrinos and the invisible χ particles.</p>
<p>The production mechanisms of interest include:  </p>
<ul>
<li>
<p><strong>Gluon fusion</strong>:<br />
  $$ gg \to t \bar{t}\,\phi \to t \bar{t} + \chi \bar{\chi} $$  </p>
</li>
<li>
<p><strong>Single top associated production</strong>:<br />
  $$ gb \to t \phi \to t + \chi \bar{\chi} $$  </p>
</li>
<li>
<p><strong>t–channel production</strong>:<br />
  $$ qq' \to tb \phi \to tb + \chi \bar{\chi} $$  </p>
</li>
</ul>
<p>In all cases, the top quarks decay via <span class="arithmatex">\(t \to W b\)</span>. Each W boson subsequently decays either leptonically (<span class="arithmatex">\(W \to \ell \nu\)</span>) or hadronically (<span class="arithmatex">\(W \to q \bar{q}'\)</span>). Thus, the final states contain a mixture of b-tagged jets, light-flavor jets, charged leptons (electrons or muons), and genuine <span class="arithmatex">\(p_T^{\text{miss}}\)</span>. The specific experimental signature depends strongly on the decay mode of the W bosons.</p>
<p>Because of this, analyses are divided into <strong>channels</strong>, each defined by the number of isolated charged leptons:</p>
<ul>
<li><strong>Single-lepton (SL):</strong> one isolated electron or muon, several jets (including ≥1 b-tag), and nonzero <span class="arithmatex">\(p_T^{\text{miss}}\)</span>. This channel is statistically powerful and relatively clean, striking a balance between signal sensitivity and manageable backgrounds.  </li>
<li><strong>All-hadronic (AH):</strong> no isolated leptons, many jets including b-tagged jets, and <span class="arithmatex">\(p_T^{\text{miss}}\)</span>. While it has the largest raw yield, it suffers from overwhelming QCD multijet background, which can fake <span class="arithmatex">\(p_T^{\text{miss}}\)</span>.  </li>
<li><strong>Dilepton:</strong> two isolated leptons, large <span class="arithmatex">\(p_T^{\text{miss}}\)</span>, and multiple jets. It provides a very clean signal region but is limited by low branching fraction, hence low statistics.</li>
</ul>
<p>In this notebook, we concentrate on the <strong>single-lepton channel with exactly one muon</strong>. There are both theoretical and practical reasons for this choice. From the physics side, the SL channel has the right compromise: it suppresses pure QCD while retaining enough events to make meaningful comparisons. From the experimental side, single-muon triggers are robust, well understood in CMS, and ensure efficient data collection. This focus allows us to demonstrate the full workflow — from event selection to histograms — in a setting where the interplay between <strong>signal characteristics</strong> and <strong>background processes</strong> can be clearly explained. Splitting into channels is therefore not a stylistic decision but a physics necessity: each final state probes the same underlying processes under different background conditions and detector signatures.</p>
<hr />
<p>After defining the objective of the project (Reproducible Analysis of CMS Open Data: Search for Dark Matter in Association with Top Quarks), we discussed in which data format to work — NanoAOD or MiniAOD. We decided to use NanoAOD, because it is lighter and optimized for analysis tasks.</p>
<p>For this reason, the environment is built with Docker, using the image:</p>
<p>cmscloud/python-vnc</p>
<p>and all development is done inside JupyterLab.</p>
<h1 id="single-lepton-channel">Single lepton channel</h1>
<h3 id="install-and-upgrade-libraries">Install and upgrade libraries</h3>
<p>First we install and upgrade the libraries that would be used to analyze the data.</p>
<pre><code class="language-python">!pip install --upgrade pip

!pip install --upgrade awkward
!pip install --upgrade uproot

!pip install fsspec-xrootd

!pip install vector

!pip install --upgrade pandas


!pip install --upgrade matplotlib

</code></pre>
<pre><code>Requirement already satisfied: pip in /usr/local/venv/lib/python3.10/site-packages (25.2)
Requirement already satisfied: awkward in /usr/local/venv/lib/python3.10/site-packages (2.8.8)
Collecting awkward
  Downloading awkward-2.8.9-py3-none-any.whl.metadata (7.5 kB)
Collecting awkward-cpp==50 (from awkward)
  Downloading awkward_cpp-50-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.2 kB)
Requirement already satisfied: fsspec&gt;=2022.11.0 in /usr/local/venv/lib/python3.10/site-packages (from awkward) (2025.2.0)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/venv/lib/python3.10/site-packages (from awkward) (8.6.1)
Requirement already satisfied: numpy&gt;=1.18.0 in /usr/local/venv/lib/python3.10/site-packages (from awkward) (2.2.3)
Requirement already satisfied: packaging in /usr/local/venv/lib/python3.10/site-packages (from awkward) (24.2)
Requirement already satisfied: typing-extensions&gt;=4.1.0 in /usr/local/venv/lib/python3.10/site-packages (from awkward) (4.12.2)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/venv/lib/python3.10/site-packages (from importlib-metadata&gt;=4.13.0-&gt;awkward) (3.21.0)
Downloading awkward-2.8.9-py3-none-any.whl (903 kB)
[2K   [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [32m903.5/903.5 kB[0m [31m6.8 MB/s[0m  [33m0:00:00[0m
Downloading awkward_cpp-50-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (653 kB)
[2K   [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [32m653.7/653.7 kB[0m [31m9.1 MB/s[0m  [33m0:00:00[0m
Installing collected packages: awkward-cpp, awkward
[2K  Attempting uninstall: awkward-cpp
[2K    Found existing installation: awkward_cpp 49
[2K    Uninstalling awkward_cpp-49:
[2K      Successfully uninstalled awkward_cpp-49
[2K  Attempting uninstall: awkward
[2K    Found existing installation: awkward 2.8.8
[2K    Uninstalling awkward-2.8.8:
[2K      Successfully uninstalled awkward-2.8.8
[2K   [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [32m2/2[0m [awkward]m1/2[0m [awkward]
Successfully installed awkward-2.8.9 awkward-cpp-50
Requirement already satisfied: uproot in /usr/local/venv/lib/python3.10/site-packages (5.6.5)
Collecting uproot
  Downloading uproot-5.6.6-py3-none-any.whl.metadata (34 kB)
Requirement already satisfied: awkward&gt;=2.4.6 in /usr/local/venv/lib/python3.10/site-packages (from uproot) (2.8.9)
Requirement already satisfied: cramjam&gt;=2.5.0 in /usr/local/venv/lib/python3.10/site-packages (from uproot) (2.9.1)
Requirement already satisfied: fsspec!=2025.7.0 in /usr/local/venv/lib/python3.10/site-packages (from uproot) (2025.2.0)
Requirement already satisfied: numpy in /usr/local/venv/lib/python3.10/site-packages (from uproot) (2.2.3)
Requirement already satisfied: packaging in /usr/local/venv/lib/python3.10/site-packages (from uproot) (24.2)
Requirement already satisfied: typing-extensions&gt;=4.1.0 in /usr/local/venv/lib/python3.10/site-packages (from uproot) (4.12.2)
Requirement already satisfied: xxhash in /usr/local/venv/lib/python3.10/site-packages (from uproot) (3.5.0)
Requirement already satisfied: awkward-cpp==50 in /usr/local/venv/lib/python3.10/site-packages (from awkward&gt;=2.4.6-&gt;uproot) (50)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/venv/lib/python3.10/site-packages (from awkward&gt;=2.4.6-&gt;uproot) (8.6.1)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/venv/lib/python3.10/site-packages (from importlib-metadata&gt;=4.13.0-&gt;awkward&gt;=2.4.6-&gt;uproot) (3.21.0)
Downloading uproot-5.6.6-py3-none-any.whl (385 kB)
Installing collected packages: uproot
  Attempting uninstall: uproot
    Found existing installation: uproot 5.6.5
    Uninstalling uproot-5.6.5:
      Successfully uninstalled uproot-5.6.5
Successfully installed uproot-5.6.6
Requirement already satisfied: fsspec-xrootd in /usr/local/venv/lib/python3.10/site-packages (0.5.0)
Requirement already satisfied: fsspec in /usr/local/venv/lib/python3.10/site-packages (from fsspec-xrootd) (2025.2.0)
Requirement already satisfied: vector in /usr/local/venv/lib/python3.10/site-packages (1.6.3)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/venv/lib/python3.10/site-packages (from vector) (2.2.3)
Requirement already satisfied: packaging&gt;=19 in /usr/local/venv/lib/python3.10/site-packages (from vector) (24.2)
Requirement already satisfied: pandas in /usr/local/venv/lib/python3.10/site-packages (2.3.2)
Collecting pandas
  Downloading pandas-2.3.3-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (91 kB)
Requirement already satisfied: numpy&gt;=1.22.4 in /usr/local/venv/lib/python3.10/site-packages (from pandas) (2.2.3)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/venv/lib/python3.10/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/venv/lib/python3.10/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/venv/lib/python3.10/site-packages (from pandas) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/venv/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
Downloading pandas-2.3.3-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (12.8 MB)
[2K   [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [32m12.8/12.8 MB[0m [31m8.5 MB/s[0m  [33m0:00:01[0mm0:00:01[0m00:01[0m
Installing collected packages: pandas
  Attempting uninstall: pandas
    Found existing installation: pandas 2.3.2
    Uninstalling pandas-2.3.2:
      Successfully uninstalled pandas-2.3.2
Successfully installed pandas-2.3.3
Requirement already satisfied: matplotlib in /usr/local/venv/lib/python3.10/site-packages (3.10.6)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy&gt;=1.23 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (2.2.3)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow&gt;=8 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (3.2.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/venv/lib/python3.10/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/venv/lib/python3.10/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.17.0)
</code></pre>
<p>We import all the libraries that we are going to use.</p>
<pre><code class="language-python">%load_ext autoreload
%autoreload 2

# The classics
import numpy as np
import matplotlib.pylab as plt
import matplotlib # To get the version

import pandas as pd

# The newcomers
import awkward as ak
import uproot

import vector
vector.register_awkward()

import requests
import os

import time

import json


%load_ext autoreload
%autoreload 2

# The classics
import numpy as np
import matplotlib.pylab as plt
import matplotlib # To get the version

import pandas as pd

import hist
from hist import Hist

# To read file names using the OS (operating system)
import glob
import os

import dpoa_workshop_utilities
from dpoa_workshop_utilities import nanoaod_filenames
from dpoa_workshop_utilities import get_files_for_dataset
from dpoa_workshop_utilities import pretty_print
from dpoa_workshop_utilities import build_lumi_mask
</code></pre>
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</code></pre>
<p>We are going to use the <code>dpoa_workshop_utilities</code> file to help you access the datasets.</p>
<p>The <code>nanoaod_filenames</code> is a dictionary with the urls to the file indexes of the root files for every dataset that we will use in the analysis.</p>
<p>The <code>get_files_for_dataset(dataset,radom,n)</code> is a function that returs the <code>n</code> root directions of the specified <code>dataset</code>, the <code>random</code> is set <code>False</code> by default and it allows you to select random urls.</p>
<p>The <code>pretty_print(fields, fmt='40s', require=None, ignore=None)</code> function allows you to print subsets of keys based on strings that you require or ignore. It will also format that output based on how many characters you want in a column (you are limited to 80 characters per line).</p>
<p>The <code>build_lumi_mask(lumifile, tree, verbose=False)</code> function helps you mask (select) the data that's collected from collisions.</p>
<p>In the next seccion will download important files like the luminosity file.</p>
<pre><code class="language-python">from IPython.display import Image, display

display(Image(filename=&quot;dataset_2016.png&quot;))

</code></pre>
<p><img alt="png" src="../output_10_0.png" /></p>
<pre><code class="language-python">
display(Image(filename=&quot;MC_data.png&quot;))

</code></pre>
<p><img alt="png" src="../output_11_0.png" /></p>
<h3 id="download-the-essential-files">Download the essential files</h3>
<p>The following code uses these utilities to access the location of the ROOT files of every dataset used in the analysis.
We download and create a file with all the ROOT's urls for every dataset.</p>
<p>We assign a name similar to <code>FILE_LIST_ttsemilep.txt</code> to these files.</p>
<pre><code class="language-python"># Descarga de las direcciones root para cada grupo de datos

for datasetname in nanoaod_filenames.keys():

    print(datasetname)

    outfilename = f'FILE_LIST_{datasetname}.txt'

    # Remove the file if it exists
    try:
        os.remove(outfilename)
    except OSError:
        pass

    for url in nanoaod_filenames[datasetname]:
        print(url)

        r = requests.get(url, allow_redirects=True)

        open(outfilename, 'a').write(r.text)

</code></pre>
<pre><code>ttsemilep
https://opendata.cern.ch/record/67993/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_120000_file_index.txt
https://opendata.cern.ch/record/67993/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_130000_file_index.txt
https://opendata.cern.ch/record/67993/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_270000_file_index.txt
https://opendata.cern.ch/record/67993/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_280000_file_index.txt
https://opendata.cern.ch/record/67993/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_70000_file_index.txt
ttop
https://opendata.cern.ch/record/64763/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_100000_file_index.txt
https://opendata.cern.ch/record/64763/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_230000_file_index.txt
https://opendata.cern.ch/record/64763/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_2430000_file_index.txt
https://opendata.cern.ch/record/64763/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_2500000_file_index.txt
https://opendata.cern.ch/record/64763/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_250000_file_index.txt
Wjets
https://opendata.cern.ch/record/69729/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_120000_file_index.txt
https://opendata.cern.ch/record/69729/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_130000_file_index.txt
https://opendata.cern.ch/record/69729/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_270000_file_index.txt
https://opendata.cern.ch/record/69729/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_280000_file_index.txt
https://opendata.cern.ch/record/69729/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_70000_file_index.txt
ttv
https://opendata.cern.ch/record/68073/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_130000_file_index.txt
https://opendata.cern.ch/record/68073/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_270000_file_index.txt
https://opendata.cern.ch/record/68073/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_280000_file_index.txt
https://opendata.cern.ch/record/68073/file_index/CMS_mc_RunIISummer20UL16NanoAODv9_TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8_NANOAODSIM_106X_mcRun2_asymptotic_v17-v1_70000_file_index.txt
collmet
https://opendata.cern.ch/record/30559/file_index/CMS_Run2016H_MET_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_120000_file_index.txt
https://opendata.cern.ch/record/30559/file_index/CMS_Run2016H_MET_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_280000_file_index.txt
https://opendata.cern.ch/record/30559/file_index/CMS_Run2016H_MET_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_70000_file_index.txt
collsm
https://opendata.cern.ch/record/30563/file_index/CMS_Run2016H_SingleMuon_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_120000_file_index.txt
https://opendata.cern.ch/record/30563/file_index/CMS_Run2016H_SingleMuon_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_1210000_file_index.txt
https://opendata.cern.ch/record/30563/file_index/CMS_Run2016H_SingleMuon_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_130000_file_index.txt
https://opendata.cern.ch/record/30563/file_index/CMS_Run2016H_SingleMuon_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_280000_file_index.txt
https://opendata.cern.ch/record/30563/file_index/CMS_Run2016H_SingleMuon_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_70000_file_index.txt
collse
https://opendata.cern.ch/record/30562/file_index/CMS_Run2016H_SingleElectron_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_120000_file_index.txt
https://opendata.cern.ch/record/30562/file_index/CMS_Run2016H_SingleElectron_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_270000_file_index.txt
https://opendata.cern.ch/record/30562/file_index/CMS_Run2016H_SingleElectron_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_280000_file_index.txt
https://opendata.cern.ch/record/30562/file_index/CMS_Run2016H_SingleElectron_NANOAOD_UL2016_MiniAODv2_NanoAODv9-v1_70000_file_index.txt
</code></pre>
<p>By running the next code we can count the number of ROOT files that are in every dataset.</p>
<pre><code class="language-python">!wc -l FILE_LIST_*.txt

</code></pre>
<pre><code>   11 FILE_LIST_Wjets.txt
   32 FILE_LIST_collmet.txt
   80 FILE_LIST_collse.txt
   82 FILE_LIST_collsm.txt
   25 FILE_LIST_ttop.txt
  138 FILE_LIST_ttsemilep.txt
   12 FILE_LIST_ttv.txt
  380 total
</code></pre>
<p>Using the <code>get_files_for_dataset</code> function we can get <code>n</code> number of ROOT files of a dataset, in this case the <code>ttsemilep</code> dataset.</p>
<pre><code class="language-python"># Pick 2 tt̄ semileptonic files
filenames = get_files_for_dataset(&quot;ttsemilep&quot;,random=True, n=2)

for f in filenames:
    print(f)

</code></pre>
<pre><code>root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/270000/CBA39E34-6BAD-B740-AB89-ECD745490CE5.root

root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/70000/7C94DA4D-C0B5-8747-B6F8-E4903C610777.root
</code></pre>
<p>In order to work with the collisions datasets it is necesary to apply a luminosity filter which you can download running the next cell.</p>
<pre><code class="language-python">!wget https://opendata.cern.ch/record/14220/files/Cert_271036-284044_13TeV_Legacy2016_Collisions16_JSON.txt

</code></pre>
<pre><code>--2025-10-02 21:34:08--  https://opendata.cern.ch/record/14220/files/Cert_271036-284044_13TeV_Legacy2016_Collisions16_JSON.txt
137.138.6.31, 2001:1458:201:8b::100:1c8rn.ch)... 
connected. to opendata.cern.ch (opendata.cern.ch)|137.138.6.31|:443... 
HTTP request sent, awaiting response... 200 OK
Length: 11686 (11K) [text/plain]
Saving to: ‘Cert_271036-284044_13TeV_Legacy2016_Collisions16_JSON.txt’

Cert_271036-284044_ 100%[===================&gt;]  11.41K  --.-KB/s    in 0s

2025-10-02 21:34:09 (91.7 MB/s) - ‘Cert_271036-284044_13TeV_Legacy2016_Collisions16_JSON.txt’ saved [11686/11686]
</code></pre>
<h2 id="selecting-the-data">Selecting the data</h2>
<p>We will work with a random file from the <code>ttsemilp</code> dataset.</p>
<pre><code class="language-python">filename = filenames[0]
print(f&quot;Opening...{filename}&quot;)
f = uproot.open(filename)

events = f['Events']
nevents = events.num_entries

print(f&quot;{nevents = }&quot;)
</code></pre>
<pre><code>Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/270000/CBA39E34-6BAD-B740-AB89-ECD745490CE5.root

nevents = 810000
</code></pre>
<p>We can see the keys with</p>
<pre><code class="language-python">print(events.keys())
</code></pre>
<pre><code>['run', 'luminosityBlock', 'event', 'HTXS_Higgs_pt', 'HTXS_Higgs_y', 'HTXS_stage1_1_cat_pTjet25GeV', 'HTXS_stage1_1_cat_pTjet30GeV', 'HTXS_stage1_1_fine_cat_pTjet25GeV', 'HTXS_stage1_1_fine_cat_pTjet30GeV', 'HTXS_stage1_2_cat_pTjet25GeV', 'HTXS_stage1_2_cat_pTjet30GeV', 'HTXS_stage1_2_fine_cat_pTjet25GeV', 'HTXS_stage1_2_fine_cat_pTjet30GeV', 'HTXS_stage_0', 'HTXS_stage_1_pTjet25', 'HTXS_stage_1_pTjet30', 'HTXS_njets25', 'HTXS_njets30', 'nboostedTau', 'boostedTau_chargedIso', 'boostedTau_eta', 'boostedTau_leadTkDeltaEta', 'boostedTau_leadTkDeltaPhi', 'boostedTau_leadTkPtOverTauPt', 'boostedTau_mass', 'boostedTau_neutralIso', 'boostedTau_phi', 'boostedTau_photonsOutsideSignalCone', 'boostedTau_pt', 'boostedTau_puCorr', 'boostedTau_rawAntiEle2018', 'boostedTau_rawIso', 'boostedTau_rawIsodR03', 'boostedTau_rawMVAnewDM2017v2', 'boostedTau_rawMVAoldDM2017v2', 'boostedTau_rawMVAoldDMdR032017v2', 'boostedTau_charge', 'boostedTau_decayMode', 'boostedTau_jetIdx', 'boostedTau_rawAntiEleCat2018', 'boostedTau_idAntiEle2018', 'boostedTau_idAntiMu', 'boostedTau_idMVAnewDM2017v2', 'boostedTau_idMVAoldDM2017v2', 'boostedTau_idMVAoldDMdR032017v2', 'btagWeight_CSVV2', 'btagWeight_DeepCSVB', 'CaloMET_phi', 'CaloMET_pt', 'CaloMET_sumEt', 'ChsMET_phi', 'ChsMET_pt', 'ChsMET_sumEt', 'nCorrT1METJet', 'CorrT1METJet_area', 'CorrT1METJet_eta', 'CorrT1METJet_muonSubtrFactor', 'CorrT1METJet_phi', 'CorrT1METJet_rawPt', 'DeepMETResolutionTune_phi', 'DeepMETResolutionTune_pt', 'DeepMETResponseTune_phi', 'DeepMETResponseTune_pt', 'nElectron', 'Electron_dEscaleDown', 'Electron_dEscaleUp', 'Electron_dEsigmaDown', 'Electron_dEsigmaUp', 'Electron_deltaEtaSC', 'Electron_dr03EcalRecHitSumEt', 'Electron_dr03HcalDepth1TowerSumEt', 'Electron_dr03TkSumPt', 'Electron_dr03TkSumPtHEEP', 'Electron_dxy', 'Electron_dxyErr', 'Electron_dz', 'Electron_dzErr', 'Electron_eCorr', 'Electron_eInvMinusPInv', 'Electron_energyErr', 'Electron_eta', 'Electron_hoe', 'Electron_ip3d', 'Electron_jetPtRelv2', 'Electron_jetRelIso', 'Electron_mass', 'Electron_miniPFRelIso_all', 'Electron_miniPFRelIso_chg', 'Electron_mvaFall17V2Iso', 'Electron_mvaFall17V2noIso', 'Electron_pfRelIso03_all', 'Electron_pfRelIso03_chg', 'Electron_phi', 'Electron_pt', 'Electron_r9', 'Electron_scEtOverPt', 'Electron_sieie', 'Electron_sip3d', 'Electron_mvaTTH', 'Electron_charge', 'Electron_cutBased', 'Electron_jetIdx', 'Electron_pdgId', 'Electron_photonIdx', 'Electron_tightCharge', 'Electron_vidNestedWPBitmap', 'Electron_vidNestedWPBitmapHEEP', 'Electron_convVeto', 'Electron_cutBased_HEEP', 'Electron_isPFcand', 'Electron_jetNDauCharged', 'Electron_lostHits', 'Electron_mvaFall17V2Iso_WP80', 'Electron_mvaFall17V2Iso_WP90', 'Electron_mvaFall17V2Iso_WPL', 'Electron_mvaFall17V2noIso_WP80', 'Electron_mvaFall17V2noIso_WP90', 'Electron_mvaFall17V2noIso_WPL', 'Electron_seedGain', 'nFatJet', 'FatJet_area', 'FatJet_btagCSVV2', 'FatJet_btagDDBvLV2', 'FatJet_btagDDCvBV2', 'FatJet_btagDDCvLV2', 'FatJet_btagDeepB', 'FatJet_btagHbb', 'FatJet_deepTagMD_H4qvsQCD', 'FatJet_deepTagMD_HbbvsQCD', 'FatJet_deepTagMD_TvsQCD', 'FatJet_deepTagMD_WvsQCD', 'FatJet_deepTagMD_ZHbbvsQCD', 'FatJet_deepTagMD_ZHccvsQCD', 'FatJet_deepTagMD_ZbbvsQCD', 'FatJet_deepTagMD_ZvsQCD', 'FatJet_deepTagMD_bbvsLight', 'FatJet_deepTagMD_ccvsLight', 'FatJet_deepTag_H', 'FatJet_deepTag_QCD', 'FatJet_deepTag_QCDothers', 'FatJet_deepTag_TvsQCD', 'FatJet_deepTag_WvsQCD', 'FatJet_deepTag_ZvsQCD', 'FatJet_eta', 'FatJet_mass', 'FatJet_msoftdrop', 'FatJet_n2b1', 'FatJet_n3b1', 'FatJet_particleNetMD_QCD', 'FatJet_particleNetMD_Xbb', 'FatJet_particleNetMD_Xcc', 'FatJet_particleNetMD_Xqq', 'FatJet_particleNet_H4qvsQCD', 'FatJet_particleNet_HbbvsQCD', 'FatJet_particleNet_HccvsQCD', 'FatJet_particleNet_QCD', 'FatJet_particleNet_TvsQCD', 'FatJet_particleNet_WvsQCD', 'FatJet_particleNet_ZvsQCD', 'FatJet_particleNet_mass', 'FatJet_phi', 'FatJet_pt', 'FatJet_rawFactor', 'FatJet_tau1', 'FatJet_tau2', 'FatJet_tau3', 'FatJet_tau4', 'FatJet_lsf3', 'FatJet_jetId', 'FatJet_subJetIdx1', 'FatJet_subJetIdx2', 'FatJet_electronIdx3SJ', 'FatJet_muonIdx3SJ', 'FatJet_nConstituents', 'nFsrPhoton', 'FsrPhoton_dROverEt2', 'FsrPhoton_eta', 'FsrPhoton_phi', 'FsrPhoton_pt', 'FsrPhoton_relIso03', 'FsrPhoton_muonIdx', 'nGenJetAK8', 'GenJetAK8_eta', 'GenJetAK8_mass', 'GenJetAK8_phi', 'GenJetAK8_pt', 'nGenJet', 'GenJet_eta', 'GenJet_mass', 'GenJet_phi', 'GenJet_pt', 'nGenPart', 'GenPart_eta', 'GenPart_mass', 'GenPart_phi', 'GenPart_pt', 'GenPart_genPartIdxMother', 'GenPart_pdgId', 'GenPart_status', 'GenPart_statusFlags', 'nSubGenJetAK8', 'SubGenJetAK8_eta', 'SubGenJetAK8_mass', 'SubGenJetAK8_phi', 'SubGenJetAK8_pt', 'Generator_binvar', 'Generator_scalePDF', 'Generator_weight', 'Generator_x1', 'Generator_x2', 'Generator_xpdf1', 'Generator_xpdf2', 'Generator_id1', 'Generator_id2', 'GenVtx_x', 'GenVtx_y', 'GenVtx_z', 'nGenVisTau', 'GenVisTau_eta', 'GenVisTau_mass', 'GenVisTau_phi', 'GenVisTau_pt', 'GenVisTau_charge', 'GenVisTau_genPartIdxMother', 'GenVisTau_status', 'genWeight', 'LHEWeight_originalXWGTUP', 'nLHEPdfWeight', 'LHEPdfWeight', 'nLHEReweightingWeight', 'LHEReweightingWeight', 'nLHEScaleWeight', 'LHEScaleWeight', 'nPSWeight', 'PSWeight', 'nIsoTrack', 'IsoTrack_dxy', 'IsoTrack_dz', 'IsoTrack_eta', 'IsoTrack_pfRelIso03_all', 'IsoTrack_pfRelIso03_chg', 'IsoTrack_phi', 'IsoTrack_pt', 'IsoTrack_miniPFRelIso_all', 'IsoTrack_miniPFRelIso_chg', 'IsoTrack_charge', 'IsoTrack_fromPV', 'IsoTrack_pdgId', 'IsoTrack_isHighPurityTrack', 'IsoTrack_isPFcand', 'IsoTrack_isFromLostTrack', 'nJet', 'Jet_area', 'Jet_btagCSVV2', 'Jet_btagDeepB', 'Jet_btagDeepCvB', 'Jet_btagDeepCvL', 'Jet_btagDeepFlavB', 'Jet_btagDeepFlavCvB', 'Jet_btagDeepFlavCvL', 'Jet_btagDeepFlavQG', 'Jet_chEmEF', 'Jet_chFPV0EF', 'Jet_chHEF', 'Jet_eta', 'Jet_hfsigmaEtaEta', 'Jet_hfsigmaPhiPhi', 'Jet_mass', 'Jet_muEF', 'Jet_muonSubtrFactor', 'Jet_neEmEF', 'Jet_neHEF', 'Jet_phi', 'Jet_pt', 'Jet_puIdDisc', 'Jet_qgl', 'Jet_rawFactor', 'Jet_bRegCorr', 'Jet_bRegRes', 'Jet_cRegCorr', 'Jet_cRegRes', 'Jet_electronIdx1', 'Jet_electronIdx2', 'Jet_hfadjacentEtaStripsSize', 'Jet_hfcentralEtaStripSize', 'Jet_jetId', 'Jet_muonIdx1', 'Jet_muonIdx2', 'Jet_nElectrons', 'Jet_nMuons', 'Jet_puId', 'Jet_nConstituents', 'L1PreFiringWeight_Dn', 'L1PreFiringWeight_ECAL_Dn', 'L1PreFiringWeight_ECAL_Nom', 'L1PreFiringWeight_ECAL_Up', 'L1PreFiringWeight_Muon_Nom', 'L1PreFiringWeight_Muon_StatDn', 'L1PreFiringWeight_Muon_StatUp', 'L1PreFiringWeight_Muon_SystDn', 'L1PreFiringWeight_Muon_SystUp', 'L1PreFiringWeight_Nom', 'L1PreFiringWeight_Up', 'LHE_HT', 'LHE_HTIncoming', 'LHE_Vpt', 'LHE_AlphaS', 'LHE_Njets', 'LHE_Nb', 'LHE_Nc', 'LHE_Nuds', 'LHE_Nglu', 'LHE_NpNLO', 'LHE_NpLO', 'nLHEPart', 'LHEPart_pt', 'LHEPart_eta', 'LHEPart_phi', 'LHEPart_mass', 'LHEPart_incomingpz', 'LHEPart_pdgId', 'LHEPart_status', 'LHEPart_spin', 'nLowPtElectron', 'LowPtElectron_ID', 'LowPtElectron_convVtxRadius', 'LowPtElectron_deltaEtaSC', 'LowPtElectron_dxy', 'LowPtElectron_dxyErr', 'LowPtElectron_dz', 'LowPtElectron_dzErr', 'LowPtElectron_eInvMinusPInv', 'LowPtElectron_embeddedID', 'LowPtElectron_energyErr', 'LowPtElectron_eta', 'LowPtElectron_hoe', 'LowPtElectron_mass', 'LowPtElectron_miniPFRelIso_all', 'LowPtElectron_miniPFRelIso_chg', 'LowPtElectron_phi', 'LowPtElectron_pt', 'LowPtElectron_ptbiased', 'LowPtElectron_r9', 'LowPtElectron_scEtOverPt', 'LowPtElectron_sieie', 'LowPtElectron_unbiased', 'LowPtElectron_charge', 'LowPtElectron_convWP', 'LowPtElectron_pdgId', 'LowPtElectron_convVeto', 'LowPtElectron_lostHits', 'GenMET_phi', 'GenMET_pt', 'MET_MetUnclustEnUpDeltaX', 'MET_MetUnclustEnUpDeltaY', 'MET_covXX', 'MET_covXY', 'MET_covYY', 'MET_phi', 'MET_pt', 'MET_significance', 'MET_sumEt', 'MET_sumPtUnclustered', 'nMuon', 'Muon_dxy', 'Muon_dxyErr', 'Muon_dxybs', 'Muon_dz', 'Muon_dzErr', 'Muon_eta', 'Muon_ip3d', 'Muon_jetPtRelv2', 'Muon_jetRelIso', 'Muon_mass', 'Muon_miniPFRelIso_all', 'Muon_miniPFRelIso_chg', 'Muon_pfRelIso03_all', 'Muon_pfRelIso03_chg', 'Muon_pfRelIso04_all', 'Muon_phi', 'Muon_pt', 'Muon_ptErr', 'Muon_segmentComp', 'Muon_sip3d', 'Muon_softMva', 'Muon_tkRelIso', 'Muon_tunepRelPt', 'Muon_mvaLowPt', 'Muon_mvaTTH', 'Muon_charge', 'Muon_jetIdx', 'Muon_nStations', 'Muon_nTrackerLayers', 'Muon_pdgId', 'Muon_tightCharge', 'Muon_fsrPhotonIdx', 'Muon_highPtId', 'Muon_highPurity', 'Muon_inTimeMuon', 'Muon_isGlobal', 'Muon_isPFcand', 'Muon_isStandalone', 'Muon_isTracker', 'Muon_jetNDauCharged', 'Muon_looseId', 'Muon_mediumId', 'Muon_mediumPromptId', 'Muon_miniIsoId', 'Muon_multiIsoId', 'Muon_mvaId', 'Muon_mvaLowPtId', 'Muon_pfIsoId', 'Muon_puppiIsoId', 'Muon_softId', 'Muon_softMvaId', 'Muon_tightId', 'Muon_tkIsoId', 'Muon_triggerIdLoose', 'nPhoton', 'Photon_dEscaleDown', 'Photon_dEscaleUp', 'Photon_dEsigmaDown', 'Photon_dEsigmaUp', 'Photon_eCorr', 'Photon_energyErr', 'Photon_eta', 'Photon_hoe', 'Photon_mass', 'Photon_mvaID', 'Photon_mvaID_Fall17V1p1', 'Photon_pfRelIso03_all', 'Photon_pfRelIso03_chg', 'Photon_phi', 'Photon_pt', 'Photon_r9', 'Photon_sieie', 'Photon_charge', 'Photon_cutBased', 'Photon_cutBased_Fall17V1Bitmap', 'Photon_electronIdx', 'Photon_jetIdx', 'Photon_pdgId', 'Photon_vidNestedWPBitmap', 'Photon_electronVeto', 'Photon_isScEtaEB', 'Photon_isScEtaEE', 'Photon_mvaID_WP80', 'Photon_mvaID_WP90', 'Photon_pixelSeed', 'Photon_seedGain', 'Pileup_nTrueInt', 'Pileup_pudensity', 'Pileup_gpudensity', 'Pileup_nPU', 'Pileup_sumEOOT', 'Pileup_sumLOOT', 'PuppiMET_phi', 'PuppiMET_phiJERDown', 'PuppiMET_phiJERUp', 'PuppiMET_phiJESDown', 'PuppiMET_phiJESUp', 'PuppiMET_phiUnclusteredDown', 'PuppiMET_phiUnclusteredUp', 'PuppiMET_pt', 'PuppiMET_ptJERDown', 'PuppiMET_ptJERUp', 'PuppiMET_ptJESDown', 'PuppiMET_ptJESUp', 'PuppiMET_ptUnclusteredDown', 'PuppiMET_ptUnclusteredUp', 'PuppiMET_sumEt', 'RawMET_phi', 'RawMET_pt', 'RawMET_sumEt', 'RawPuppiMET_phi', 'RawPuppiMET_pt', 'RawPuppiMET_sumEt', 'fixedGridRhoFastjetAll', 'fixedGridRhoFastjetCentral', 'fixedGridRhoFastjetCentralCalo', 'fixedGridRhoFastjetCentralChargedPileUp', 'fixedGridRhoFastjetCentralNeutral', 'nGenDressedLepton', 'GenDressedLepton_eta', 'GenDressedLepton_mass', 'GenDressedLepton_phi', 'GenDressedLepton_pt', 'GenDressedLepton_pdgId', 'GenDressedLepton_hasTauAnc', 'nGenIsolatedPhoton', 'GenIsolatedPhoton_eta', 'GenIsolatedPhoton_mass', 'GenIsolatedPhoton_phi', 'GenIsolatedPhoton_pt', 'nSoftActivityJet', 'SoftActivityJet_eta', 'SoftActivityJet_phi', 'SoftActivityJet_pt', 'SoftActivityJetHT', 'SoftActivityJetHT10', 'SoftActivityJetHT2', 'SoftActivityJetHT5', 'SoftActivityJetNjets10', 'SoftActivityJetNjets2', 'SoftActivityJetNjets5', 'nSubJet', 'SubJet_btagCSVV2', 'SubJet_btagDeepB', 'SubJet_eta', 'SubJet_mass', 'SubJet_n2b1', 'SubJet_n3b1', 'SubJet_phi', 'SubJet_pt', 'SubJet_rawFactor', 'SubJet_tau1', 'SubJet_tau2', 'SubJet_tau3', 'SubJet_tau4', 'nTau', 'Tau_chargedIso', 'Tau_dxy', 'Tau_dz', 'Tau_eta', 'Tau_leadTkDeltaEta', 'Tau_leadTkDeltaPhi', 'Tau_leadTkPtOverTauPt', 'Tau_mass', 'Tau_neutralIso', 'Tau_phi', 'Tau_photonsOutsideSignalCone', 'Tau_pt', 'Tau_puCorr', 'Tau_rawDeepTau2017v2p1VSe', 'Tau_rawDeepTau2017v2p1VSjet', 'Tau_rawDeepTau2017v2p1VSmu', 'Tau_rawIso', 'Tau_rawIsodR03', 'Tau_charge', 'Tau_decayMode', 'Tau_jetIdx', 'Tau_idAntiEleDeadECal', 'Tau_idAntiMu', 'Tau_idDecayModeOldDMs', 'Tau_idDeepTau2017v2p1VSe', 'Tau_idDeepTau2017v2p1VSjet', 'Tau_idDeepTau2017v2p1VSmu', 'TkMET_phi', 'TkMET_pt', 'TkMET_sumEt', 'nTrigObj', 'TrigObj_pt', 'TrigObj_eta', 'TrigObj_phi', 'TrigObj_l1pt', 'TrigObj_l1pt_2', 'TrigObj_l2pt', 'TrigObj_id', 'TrigObj_l1iso', 'TrigObj_l1charge', 'TrigObj_filterBits', 'genTtbarId', 'nOtherPV', 'OtherPV_z', 'PV_ndof', 'PV_x', 'PV_y', 'PV_z', 'PV_chi2', 'PV_score', 'PV_npvs', 'PV_npvsGood', 'nSV', 'SV_dlen', 'SV_dlenSig', 'SV_dxy', 'SV_dxySig', 'SV_pAngle', 'SV_charge', 'boostedTau_genPartIdx', 'boostedTau_genPartFlav', 'Electron_genPartIdx', 'Electron_genPartFlav', 'FatJet_genJetAK8Idx', 'FatJet_hadronFlavour', 'FatJet_nBHadrons', 'FatJet_nCHadrons', 'GenJetAK8_partonFlavour', 'GenJetAK8_hadronFlavour', 'GenJet_partonFlavour', 'GenJet_hadronFlavour', 'GenVtx_t0', 'Jet_genJetIdx', 'Jet_hadronFlavour', 'Jet_partonFlavour', 'LowPtElectron_genPartIdx', 'LowPtElectron_genPartFlav', 'Muon_genPartIdx', 'Muon_genPartFlav', 'Photon_genPartIdx', 'Photon_genPartFlav', 'MET_fiducialGenPhi', 'MET_fiducialGenPt', 'Electron_cleanmask', 'Jet_cleanmask', 'Muon_cleanmask', 'Photon_cleanmask', 'Tau_cleanmask', 'SubJet_hadronFlavour', 'SubJet_nBHadrons', 'SubJet_nCHadrons', 'SV_chi2', 'SV_eta', 'SV_mass', 'SV_ndof', 'SV_phi', 'SV_pt', 'SV_x', 'SV_y', 'SV_z', 'SV_ntracks', 'Tau_genPartIdx', 'Tau_genPartFlav', 'L1_AlwaysTrue', 'L1_BRIL_TRIG0_AND', 'L1_BRIL_TRIG0_FstBunchInTrain', 'L1_BRIL_TRIG0_OR', 'L1_BRIL_TRIG0_delayedAND', 'L1_BeamGasB1', 'L1_BeamGasB2', 'L1_BeamGasMinus', 'L1_BeamGasPlus', 'L1_BptxMinus', 'L1_BptxOR', 'L1_BptxPlus', 'L1_BptxXOR', 'L1_DoubleEG6_HTT255', 'L1_DoubleEG_15_10', 'L1_DoubleEG_18_17', 'L1_DoubleEG_20_18', 'L1_DoubleEG_22_10', 'L1_DoubleEG_22_12', 'L1_DoubleEG_22_15', 'L1_DoubleEG_23_10', 'L1_DoubleEG_24_17', 'L1_DoubleEG_25_12', 'L1_DoubleIsoTau28er', 'L1_DoubleIsoTau30er', 'L1_DoubleIsoTau32er', 'L1_DoubleIsoTau33er', 'L1_DoubleIsoTau34er', 'L1_DoubleIsoTau35er', 'L1_DoubleIsoTau36er', 'L1_DoubleJet12_ForwardBackward', 'L1_DoubleJet16_ForwardBackward', 'L1_DoubleJet8_ForwardBackward', 'L1_DoubleJetC100', 'L1_DoubleJetC112', 'L1_DoubleJetC120', 'L1_DoubleJetC40', 'L1_DoubleJetC50', 'L1_DoubleJetC60', 'L1_DoubleJetC60_ETM60', 'L1_DoubleJetC80', 'L1_DoubleMu0', 'L1_DoubleMu0_ETM40', 'L1_DoubleMu0_ETM55', 'L1_DoubleMu0er1p4_dEta_Max1p8_OS', 'L1_DoubleMu0er1p6_dEta_Max1p8', 'L1_DoubleMu0er1p6_dEta_Max1p8_OS', 'L1_DoubleMu7_EG14', 'L1_DoubleMu7_EG7', 'L1_DoubleMuOpen', 'L1_DoubleMu_10_0_dEta_Max1p8', 'L1_DoubleMu_10_3p5', 'L1_DoubleMu_10_Open', 'L1_DoubleMu_11_4', 'L1_DoubleMu_12_5', 'L1_DoubleMu_12_8', 'L1_DoubleMu_13_6', 'L1_DoubleMu_15_5', 'L1_DoubleTau50er', 'L1_EG25er_HTT125', 'L1_EG27er_HTT200', 'L1_ETM100', 'L1_ETM120', 'L1_ETM30', 'L1_ETM40', 'L1_ETM50', 'L1_ETM60', 'L1_ETM70', 'L1_ETM75', 'L1_ETM75_Jet60_dPhi_Min0p4', 'L1_ETM80', 'L1_ETM85', 'L1_ETM90', 'L1_ETM95', 'L1_ETT25', 'L1_ETT35_BptxAND', 'L1_ETT40_BptxAND', 'L1_ETT50_BptxAND', 'L1_ETT60_BptxAND', 'L1_FirstBunchAfterTrain', 'L1_FirstBunchInTrain', 'L1_HTM100', 'L1_HTM120', 'L1_HTM130', 'L1_HTM140', 'L1_HTM150', 'L1_HTM50', 'L1_HTM60_HTT260', 'L1_HTM70', 'L1_HTM80', 'L1_HTM80_HTT220', 'L1_HTT120', 'L1_HTT160', 'L1_HTT200', 'L1_HTT220', 'L1_HTT240', 'L1_HTT255', 'L1_HTT270', 'L1_HTT280', 'L1_HTT300', 'L1_HTT320', 'L1_IsoEG18er_IsoTau24er_dEta_Min0p2', 'L1_IsoEG20er_IsoTau25er_dEta_Min0p2', 'L1_IsoEG22er_IsoTau26er_dEta_Min0p2', 'L1_IsoEG22er_Tau20er_dEta_Min0p2', 'L1_IsolatedBunch', 'L1_Jet32_DoubleMu_10_0_dPhi_Jet_Mu0_Max0p4_dPhi_Mu_Mu_Min1p0', 'L1_Jet32_Mu0_EG10_dPhi_Jet_Mu_Max0p4_dPhi_Mu_EG_Min1p0', 'L1_MU20_EG15', 'L1_MinimumBiasHF0_AND', 'L1_MinimumBiasHF0_AND_BptxAND', 'L1_MinimumBiasHF0_OR', 'L1_MinimumBiasHF0_OR_BptxAND', 'L1_MinimumBiasHF1_AND', 'L1_MinimumBiasHF1_AND_BptxAND', 'L1_MinimumBiasHF1_OR', 'L1_MinimumBiasHF1_OR_BptxAND', 'L1_Mu0er_ETM40', 'L1_Mu0er_ETM55', 'L1_Mu10er_ETM30', 'L1_Mu10er_ETM50', 'L1_Mu12_EG10', 'L1_Mu14er_ETM30', 'L1_Mu16er_Tau20er', 'L1_Mu16er_Tau24er', 'L1_Mu18er_IsoTau26er', 'L1_Mu18er_Tau20er', 'L1_Mu18er_Tau24er', 'L1_Mu20_EG10', 'L1_Mu20_EG17', 'L1_Mu20_IsoEG6', 'L1_Mu20er_IsoTau26er', 'L1_Mu22er_IsoTau26er', 'L1_Mu23_EG10', 'L1_Mu23_IsoEG10', 'L1_Mu25er_IsoTau26er', 'L1_Mu3_JetC120', 'L1_Mu3_JetC120_dEta_Max0p4_dPhi_Max0p4', 'L1_Mu3_JetC16', 'L1_Mu3_JetC16_dEta_Max0p4_dPhi_Max0p4', 'L1_Mu3_JetC60', 'L1_Mu3_JetC60_dEta_Max0p4_dPhi_Max0p4', 'L1_Mu5_EG15', 'L1_Mu5_EG20', 'L1_Mu5_EG23', 'L1_Mu5_IsoEG18', 'L1_Mu5_IsoEG20', 'L1_Mu6_DoubleEG10', 'L1_Mu6_DoubleEG17', 'L1_Mu6_HTT200', 'L1_Mu8_HTT150', 'L1_NotBptxOR', 'L1_QuadJetC36_Tau52', 'L1_QuadJetC40', 'L1_QuadJetC50', 'L1_QuadJetC60', 'L1_QuadMu0', 'L1_SingleEG10', 'L1_SingleEG15', 'L1_SingleEG18', 'L1_SingleEG24', 'L1_SingleEG26', 'L1_SingleEG28', 'L1_SingleEG2_BptxAND', 'L1_SingleEG30', 'L1_SingleEG32', 'L1_SingleEG34', 'L1_SingleEG36', 'L1_SingleEG38', 'L1_SingleEG40', 'L1_SingleEG45', 'L1_SingleEG5', 'L1_SingleIsoEG18', 'L1_SingleIsoEG18er', 'L1_SingleIsoEG20', 'L1_SingleIsoEG20er', 'L1_SingleIsoEG22', 'L1_SingleIsoEG22er', 'L1_SingleIsoEG24', 'L1_SingleIsoEG24er', 'L1_SingleIsoEG26', 'L1_SingleIsoEG26er', 'L1_SingleIsoEG28', 'L1_SingleIsoEG28er', 'L1_SingleIsoEG30', 'L1_SingleIsoEG30er', 'L1_SingleIsoEG32', 'L1_SingleIsoEG32er', 'L1_SingleIsoEG34', 'L1_SingleIsoEG34er', 'L1_SingleIsoEG36', 'L1_SingleJet120', 'L1_SingleJet12_BptxAND', 'L1_SingleJet140', 'L1_SingleJet150', 'L1_SingleJet16', 'L1_SingleJet160', 'L1_SingleJet170', 'L1_SingleJet180', 'L1_SingleJet20', 'L1_SingleJet200', 'L1_SingleJet35', 'L1_SingleJet60', 'L1_SingleJet8_BptxAND', 'L1_SingleJet90', 'L1_SingleJetC20_NotBptxOR', 'L1_SingleJetC20_NotBptxOR_3BX', 'L1_SingleJetC32_NotBptxOR', 'L1_SingleJetC32_NotBptxOR_3BX', 'L1_SingleJetC36_NotBptxOR_3BX', 'L1_SingleMu10_LowQ', 'L1_SingleMu12', 'L1_SingleMu14', 'L1_SingleMu14er', 'L1_SingleMu16', 'L1_SingleMu16er', 'L1_SingleMu18', 'L1_SingleMu18er', 'L1_SingleMu20', 'L1_SingleMu20er', 'L1_SingleMu22', 'L1_SingleMu22er', 'L1_SingleMu25', 'L1_SingleMu25er', 'L1_SingleMu3', 'L1_SingleMu30', 'L1_SingleMu30er', 'L1_SingleMu5', 'L1_SingleMu7', 'L1_SingleMuCosmics', 'L1_SingleMuOpen', 'L1_SingleMuOpen_NotBptxOR', 'L1_SingleMuOpen_NotBptxOR_3BX', 'L1_SingleTau100er', 'L1_SingleTau120er', 'L1_SingleTau80er', 'L1_TripleEG_14_10_8', 'L1_TripleEG_18_17_8', 'L1_TripleJet_84_68_48_VBF', 'L1_TripleJet_88_72_56_VBF', 'L1_TripleJet_92_76_64_VBF', 'L1_TripleMu0', 'L1_TripleMu_5_0_0', 'L1_TripleMu_5_5_3', 'L1_ZeroBias', 'L1_ZeroBias_FirstCollidingBunch', 'L1_ZeroBias_copy', 'L1_UnprefireableEvent', 'Flag_HBHENoiseFilter', 'Flag_HBHENoiseIsoFilter', 'Flag_CSCTightHaloFilter', 'Flag_CSCTightHaloTrkMuUnvetoFilter', 'Flag_CSCTightHalo2015Filter', 'Flag_globalTightHalo2016Filter', 'Flag_globalSuperTightHalo2016Filter', 'Flag_HcalStripHaloFilter', 'Flag_hcalLaserEventFilter', 'Flag_EcalDeadCellTriggerPrimitiveFilter', 'Flag_EcalDeadCellBoundaryEnergyFilter', 'Flag_ecalBadCalibFilter', 'Flag_goodVertices', 'Flag_eeBadScFilter', 'Flag_ecalLaserCorrFilter', 'Flag_trkPOGFilters', 'Flag_chargedHadronTrackResolutionFilter', 'Flag_muonBadTrackFilter', 'Flag_BadChargedCandidateFilter', 'Flag_BadPFMuonFilter', 'Flag_BadPFMuonDzFilter', 'Flag_hfNoisyHitsFilter', 'Flag_BadChargedCandidateSummer16Filter', 'Flag_BadPFMuonSummer16Filter', 'Flag_trkPOG_manystripclus53X', 'Flag_trkPOG_toomanystripclus53X', 'Flag_trkPOG_logErrorTooManyClusters', 'Flag_METFilters', 'L1Reco_step', 'HLTriggerFirstPath', 'HLT_AK8PFJet360_TrimMass30', 'HLT_AK8PFJet400_TrimMass30', 'HLT_AK8PFHT750_TrimMass50', 'HLT_AK8PFHT800_TrimMass50', 'HLT_AK8DiPFJet300_200_TrimMass30_BTagCSV_p20', 'HLT_AK8DiPFJet280_200_TrimMass30_BTagCSV_p087', 'HLT_AK8DiPFJet300_200_TrimMass30_BTagCSV_p087', 'HLT_AK8DiPFJet300_200_TrimMass30', 'HLT_AK8PFHT700_TrimR0p1PT0p03Mass50', 'HLT_AK8PFHT650_TrimR0p1PT0p03Mass50', 'HLT_AK8PFHT600_TrimR0p1PT0p03Mass50_BTagCSV_p20', 'HLT_AK8DiPFJet280_200_TrimMass30', 'HLT_AK8DiPFJet250_200_TrimMass30', 'HLT_AK8DiPFJet280_200_TrimMass30_BTagCSV_p20', 'HLT_AK8DiPFJet250_200_TrimMass30_BTagCSV_p20', 'HLT_CaloJet260', 'HLT_CaloJet500_NoJetID', 'HLT_Dimuon13_PsiPrime', 'HLT_Dimuon13_Upsilon', 'HLT_Dimuon20_Jpsi', 'HLT_DoubleEle24_22_eta2p1_WPLoose_Gsf', 'HLT_DoubleEle25_CaloIdL_GsfTrkIdVL', 'HLT_DoubleEle33_CaloIdL', 'HLT_DoubleEle33_CaloIdL_MW', 'HLT_DoubleEle33_CaloIdL_GsfTrkIdVL_MW', 'HLT_DoubleEle33_CaloIdL_GsfTrkIdVL', 'HLT_DoubleMediumCombinedIsoPFTau35_Trk1_eta2p1_Reg', 'HLT_DoubleTightCombinedIsoPFTau35_Trk1_eta2p1_Reg', 'HLT_DoubleMediumCombinedIsoPFTau40_Trk1_eta2p1_Reg', 'HLT_DoubleTightCombinedIsoPFTau40_Trk1_eta2p1_Reg', 'HLT_DoubleMediumCombinedIsoPFTau40_Trk1_eta2p1', 'HLT_DoubleTightCombinedIsoPFTau40_Trk1_eta2p1', 'HLT_DoubleMediumIsoPFTau35_Trk1_eta2p1_Reg', 'HLT_DoubleMediumIsoPFTau40_Trk1_eta2p1_Reg', 'HLT_DoubleMediumIsoPFTau40_Trk1_eta2p1', 'HLT_DoubleEle37_Ele27_CaloIdL_GsfTrkIdVL', 'HLT_DoubleMu33NoFiltersNoVtx', 'HLT_DoubleMu38NoFiltersNoVtx', 'HLT_DoubleMu23NoFiltersNoVtxDisplaced', 'HLT_DoubleMu28NoFiltersNoVtxDisplaced', 'HLT_DoubleMu0', 'HLT_DoubleMu4_3_Bs', 'HLT_DoubleMu4_3_Jpsi_Displaced', 'HLT_DoubleMu4_JpsiTrk_Displaced', 'HLT_DoubleMu4_LowMassNonResonantTrk_Displaced', 'HLT_DoubleMu3_Trk_Tau3mu', 'HLT_DoubleMu4_PsiPrimeTrk_Displaced', 'HLT_Mu7p5_L2Mu2_Jpsi', 'HLT_Mu7p5_L2Mu2_Upsilon', 'HLT_Mu7p5_Track2_Jpsi', 'HLT_Mu7p5_Track3p5_Jpsi', 'HLT_Mu7p5_Track7_Jpsi', 'HLT_Mu7p5_Track2_Upsilon', 'HLT_Mu7p5_Track3p5_Upsilon', 'HLT_Mu7p5_Track7_Upsilon', 'HLT_Dimuon0er16_Jpsi_NoOS_NoVertexing', 'HLT_Dimuon0er16_Jpsi_NoVertexing', 'HLT_Dimuon6_Jpsi_NoVertexing', 'HLT_Photon150', 'HLT_Photon90_CaloIdL_HT300', 'HLT_HT250_CaloMET70', 'HLT_DoublePhoton60', 'HLT_DoublePhoton85', 'HLT_Ele17_Ele8_Gsf', 'HLT_Ele20_eta2p1_WPLoose_Gsf_LooseIsoPFTau28', 'HLT_Ele22_eta2p1_WPLoose_Gsf_LooseIsoPFTau29', 'HLT_Ele22_eta2p1_WPLoose_Gsf', 'HLT_Ele22_eta2p1_WPLoose_Gsf_LooseIsoPFTau20_SingleL1', 'HLT_Ele23_WPLoose_Gsf', 'HLT_Ele23_WPLoose_Gsf_WHbbBoost', 'HLT_Ele24_eta2p1_WPLoose_Gsf', 'HLT_Ele24_eta2p1_WPLoose_Gsf_LooseIsoPFTau20', 'HLT_Ele24_eta2p1_WPLoose_Gsf_LooseIsoPFTau20_SingleL1', 'HLT_Ele24_eta2p1_WPLoose_Gsf_LooseIsoPFTau30', 'HLT_Ele25_WPTight_Gsf', 'HLT_Ele25_eta2p1_WPLoose_Gsf', 'HLT_Ele25_eta2p1_WPTight_Gsf', 'HLT_Ele27_WPLoose_Gsf', 'HLT_Ele27_WPLoose_Gsf_WHbbBoost', 'HLT_Ele27_WPTight_Gsf', 'HLT_Ele27_WPTight_Gsf_L1JetTauSeeded', 'HLT_Ele27_eta2p1_WPLoose_Gsf', 'HLT_Ele27_eta2p1_WPLoose_Gsf_LooseIsoPFTau20_SingleL1', 'HLT_Ele27_eta2p1_WPTight_Gsf', 'HLT_Ele30_WPTight_Gsf', 'HLT_Ele30_eta2p1_WPLoose_Gsf', 'HLT_Ele30_eta2p1_WPTight_Gsf', 'HLT_Ele32_WPTight_Gsf', 'HLT_Ele32_eta2p1_WPLoose_Gsf', 'HLT_Ele32_eta2p1_WPLoose_Gsf_LooseIsoPFTau20_SingleL1', 'HLT_Ele32_eta2p1_WPTight_Gsf', 'HLT_Ele35_WPLoose_Gsf', 'HLT_Ele35_CaloIdVT_GsfTrkIdT_PFJet150_PFJet50', 'HLT_Ele36_eta2p1_WPLoose_Gsf_LooseIsoPFTau20_SingleL1', 'HLT_Ele45_WPLoose_Gsf', 'HLT_Ele45_WPLoose_Gsf_L1JetTauSeeded', 'HLT_Ele45_CaloIdVT_GsfTrkIdT_PFJet200_PFJet50', 'HLT_Ele105_CaloIdVT_GsfTrkIdT', 'HLT_Ele30WP60_SC4_Mass55', 'HLT_Ele30WP60_Ele8_Mass55', 'HLT_HT200', 'HLT_HT275', 'HLT_HT325', 'HLT_HT425', 'HLT_HT575', 'HLT_HT410to430', 'HLT_HT430to450', 'HLT_HT450to470', 'HLT_HT470to500', 'HLT_HT500to550', 'HLT_HT550to650', 'HLT_HT650', 'HLT_Mu16_eta2p1_MET30', 'HLT_IsoMu16_eta2p1_MET30', 'HLT_IsoMu16_eta2p1_MET30_LooseIsoPFTau50_Trk30_eta2p1', 'HLT_IsoMu17_eta2p1', 'HLT_IsoMu17_eta2p1_LooseIsoPFTau20', 'HLT_IsoMu17_eta2p1_LooseIsoPFTau20_SingleL1', 'HLT_DoubleIsoMu17_eta2p1', 'HLT_DoubleIsoMu17_eta2p1_noDzCut', 'HLT_IsoMu18', 'HLT_IsoMu19_eta2p1_LooseIsoPFTau20', 'HLT_IsoMu19_eta2p1_LooseIsoPFTau20_SingleL1', 'HLT_IsoMu19_eta2p1_MediumIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu19_eta2p1_LooseCombinedIsoPFTau20', 'HLT_IsoMu19_eta2p1_MediumCombinedIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu19_eta2p1_TightCombinedIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu21_eta2p1_MediumCombinedIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu21_eta2p1_TightCombinedIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu20', 'HLT_IsoMu21_eta2p1_LooseIsoPFTau20_SingleL1', 'HLT_IsoMu21_eta2p1_LooseIsoPFTau50_Trk30_eta2p1_SingleL1', 'HLT_IsoMu21_eta2p1_MediumIsoPFTau32_Trk1_eta2p1_Reg', 'HLT_IsoMu22', 'HLT_IsoMu22_eta2p1', 'HLT_IsoMu24', 'HLT_IsoMu27', 'HLT_IsoTkMu18', 'HLT_IsoTkMu20', 'HLT_IsoTkMu22', 'HLT_IsoTkMu22_eta2p1', 'HLT_IsoTkMu24', 'HLT_IsoTkMu27', 'HLT_JetE30_NoBPTX3BX', 'HLT_JetE30_NoBPTX', 'HLT_JetE50_NoBPTX3BX', 'HLT_JetE70_NoBPTX3BX', 'HLT_L1SingleMu18', 'HLT_L2Mu10', 'HLT_L1SingleMuOpen', 'HLT_L1SingleMuOpen_DT', 'HLT_L2DoubleMu23_NoVertex', 'HLT_L2DoubleMu28_NoVertex_2Cha_Angle2p5_Mass10', 'HLT_L2DoubleMu38_NoVertex_2Cha_Angle2p5_Mass10', 'HLT_L2Mu10_NoVertex_NoBPTX3BX', 'HLT_L2Mu10_NoVertex_NoBPTX', 'HLT_L2Mu45_NoVertex_3Sta_NoBPTX3BX', 'HLT_L2Mu40_NoVertex_3Sta_NoBPTX3BX', 'HLT_LooseIsoPFTau50_Trk30_eta2p1', 'HLT_LooseIsoPFTau50_Trk30_eta2p1_MET80', 'HLT_LooseIsoPFTau50_Trk30_eta2p1_MET90', 'HLT_LooseIsoPFTau50_Trk30_eta2p1_MET110', 'HLT_LooseIsoPFTau50_Trk30_eta2p1_MET120', 'HLT_PFTau120_eta2p1', 'HLT_PFTau140_eta2p1', 'HLT_VLooseIsoPFTau120_Trk50_eta2p1', 'HLT_VLooseIsoPFTau140_Trk50_eta2p1', 'HLT_Mu17_Mu8', 'HLT_Mu17_Mu8_DZ', 'HLT_Mu17_Mu8_SameSign', 'HLT_Mu17_Mu8_SameSign_DZ', 'HLT_Mu20_Mu10', 'HLT_Mu20_Mu10_DZ', 'HLT_Mu20_Mu10_SameSign', 'HLT_Mu20_Mu10_SameSign_DZ', 'HLT_Mu17_TkMu8_DZ', 'HLT_Mu17_TrkIsoVVL_Mu8_TrkIsoVVL', 'HLT_Mu17_TrkIsoVVL_Mu8_TrkIsoVVL_DZ', 'HLT_Mu17_TrkIsoVVL_TkMu8_TrkIsoVVL', 'HLT_Mu17_TrkIsoVVL_TkMu8_TrkIsoVVL_DZ', 'HLT_Mu25_TkMu0_dEta18_Onia', 'HLT_Mu27_TkMu8', 'HLT_Mu30_TkMu11', 'HLT_Mu30_eta2p1_PFJet150_PFJet50', 'HLT_Mu40_TkMu11', 'HLT_Mu40_eta2p1_PFJet200_PFJet50', 'HLT_Mu20', 'HLT_TkMu17', 'HLT_TkMu17_TrkIsoVVL_TkMu8_TrkIsoVVL', 'HLT_TkMu17_TrkIsoVVL_TkMu8_TrkIsoVVL_DZ', 'HLT_TkMu20', 'HLT_Mu24_eta2p1', 'HLT_TkMu24_eta2p1', 'HLT_Mu27', 'HLT_TkMu27', 'HLT_Mu45_eta2p1', 'HLT_Mu50', 'HLT_TkMu50', 'HLT_Mu38NoFiltersNoVtx_Photon38_CaloIdL', 'HLT_Mu42NoFiltersNoVtx_Photon42_CaloIdL', 'HLT_Mu28NoFiltersNoVtxDisplaced_Photon28_CaloIdL', 'HLT_Mu33NoFiltersNoVtxDisplaced_Photon33_CaloIdL', 'HLT_Mu23NoFiltersNoVtx_Photon23_CaloIdL', 'HLT_DoubleMu18NoFiltersNoVtx', 'HLT_Mu33NoFiltersNoVtxDisplaced_DisplacedJet50_Tight', 'HLT_Mu33NoFiltersNoVtxDisplaced_DisplacedJet50_Loose', 'HLT_Mu28NoFiltersNoVtx_DisplacedJet40_Loose', 'HLT_Mu38NoFiltersNoVtxDisplaced_DisplacedJet60_Tight', 'HLT_Mu38NoFiltersNoVtxDisplaced_DisplacedJet60_Loose', 'HLT_Mu38NoFiltersNoVtx_DisplacedJet60_Loose', 'HLT_Mu28NoFiltersNoVtx_CentralCaloJet40', 'HLT_PFHT300_PFMET100', 'HLT_PFHT300_PFMET110', 'HLT_PFHT550_4JetPt50', 'HLT_PFHT650_4JetPt50', 'HLT_PFHT750_4JetPt50', 'HLT_PFHT750_4JetPt70', 'HLT_PFHT750_4JetPt80', 'HLT_PFHT800_4JetPt50', 'HLT_PFHT850_4JetPt50', 'HLT_PFJet15_NoCaloMatched', 'HLT_PFJet25_NoCaloMatched', 'HLT_DiPFJet15_NoCaloMatched', 'HLT_DiPFJet25_NoCaloMatched', 'HLT_DiPFJet15_FBEta3_NoCaloMatched', 'HLT_DiPFJet25_FBEta3_NoCaloMatched', 'HLT_DiPFJetAve15_HFJEC', 'HLT_DiPFJetAve25_HFJEC', 'HLT_DiPFJetAve35_HFJEC', 'HLT_AK8PFJet40', 'HLT_AK8PFJet60', 'HLT_AK8PFJet80', 'HLT_AK8PFJet140', 'HLT_AK8PFJet200', 'HLT_AK8PFJet260', 'HLT_AK8PFJet320', 'HLT_AK8PFJet400', 'HLT_AK8PFJet450', 'HLT_AK8PFJet500', 'HLT_PFJet40', 'HLT_PFJet60', 'HLT_PFJet80', 'HLT_PFJet140', 'HLT_PFJet200', 'HLT_PFJet260', 'HLT_PFJet320', 'HLT_PFJet400', 'HLT_PFJet450', 'HLT_PFJet500', 'HLT_DiPFJetAve40', 'HLT_DiPFJetAve60', 'HLT_DiPFJetAve80', 'HLT_DiPFJetAve140', 'HLT_DiPFJetAve200', 'HLT_DiPFJetAve260', 'HLT_DiPFJetAve320', 'HLT_DiPFJetAve400', 'HLT_DiPFJetAve500', 'HLT_DiPFJetAve60_HFJEC', 'HLT_DiPFJetAve80_HFJEC', 'HLT_DiPFJetAve100_HFJEC', 'HLT_DiPFJetAve160_HFJEC', 'HLT_DiPFJetAve220_HFJEC', 'HLT_DiPFJetAve300_HFJEC', 'HLT_DiPFJet40_DEta3p5_MJJ600_PFMETNoMu140', 'HLT_DiPFJet40_DEta3p5_MJJ600_PFMETNoMu80', 'HLT_DiCentralPFJet170', 'HLT_SingleCentralPFJet170_CFMax0p1', 'HLT_DiCentralPFJet170_CFMax0p1', 'HLT_DiCentralPFJet220_CFMax0p3', 'HLT_DiCentralPFJet330_CFMax0p5', 'HLT_DiCentralPFJet430', 'HLT_PFHT125', 'HLT_PFHT200', 'HLT_PFHT250', 'HLT_PFHT300', 'HLT_PFHT350', 'HLT_PFHT400', 'HLT_PFHT475', 'HLT_PFHT600', 'HLT_PFHT650', 'HLT_PFHT800', 'HLT_PFHT900', 'HLT_PFHT200_PFAlphaT0p51', 'HLT_PFHT200_DiPFJetAve90_PFAlphaT0p57', 'HLT_PFHT200_DiPFJetAve90_PFAlphaT0p63', 'HLT_PFHT250_DiPFJetAve90_PFAlphaT0p55', 'HLT_PFHT250_DiPFJetAve90_PFAlphaT0p58', 'HLT_PFHT300_DiPFJetAve90_PFAlphaT0p53', 'HLT_PFHT300_DiPFJetAve90_PFAlphaT0p54', 'HLT_PFHT350_DiPFJetAve90_PFAlphaT0p52', 'HLT_PFHT350_DiPFJetAve90_PFAlphaT0p53', 'HLT_PFHT400_DiPFJetAve90_PFAlphaT0p51', 'HLT_PFHT400_DiPFJetAve90_PFAlphaT0p52', 'HLT_MET60_IsoTrk35_Loose', 'HLT_MET75_IsoTrk50', 'HLT_MET90_IsoTrk50', 'HLT_PFMET120_BTagCSV_p067', 'HLT_PFMET120_Mu5', 'HLT_PFMET170_NotCleaned', 'HLT_PFMET170_NoiseCleaned', 'HLT_PFMET170_HBHECleaned', 'HLT_PFMET170_JetIdCleaned', 'HLT_PFMET170_BeamHaloCleaned', 'HLT_PFMET170_HBHE_BeamHaloCleaned', 'HLT_PFMETTypeOne190_HBHE_BeamHaloCleaned', 'HLT_PFMET90_PFMHT90_IDTight', 'HLT_PFMET100_PFMHT100_IDTight', 'HLT_PFMET100_PFMHT100_IDTight_BeamHaloCleaned', 'HLT_PFMET110_PFMHT110_IDTight', 'HLT_PFMET120_PFMHT120_IDTight', 'HLT_CaloMHTNoPU90_PFMET90_PFMHT90_IDTight_BTagCSV_p067', 'HLT_CaloMHTNoPU90_PFMET90_PFMHT90_IDTight', 'HLT_QuadPFJet_BTagCSV_p016_p11_VBF_Mqq200', 'HLT_QuadPFJet_BTagCSV_p016_VBF_Mqq460', 'HLT_QuadPFJet_BTagCSV_p016_p11_VBF_Mqq240', 'HLT_QuadPFJet_BTagCSV_p016_VBF_Mqq500', 'HLT_QuadPFJet_VBF', 'HLT_L1_TripleJet_VBF', 'HLT_QuadJet45_TripleBTagCSV_p087', 'HLT_QuadJet45_DoubleBTagCSV_p087', 'HLT_DoubleJet90_Double30_TripleBTagCSV_p087', 'HLT_DoubleJet90_Double30_DoubleBTagCSV_p087', 'HLT_DoubleJetsC100_DoubleBTagCSV_p026_DoublePFJetsC160', 'HLT_DoubleJetsC100_DoubleBTagCSV_p014_DoublePFJetsC100MaxDeta1p6', 'HLT_DoubleJetsC112_DoubleBTagCSV_p026_DoublePFJetsC172', 'HLT_DoubleJetsC112_DoubleBTagCSV_p014_DoublePFJetsC112MaxDeta1p6', 'HLT_DoubleJetsC100_SingleBTagCSV_p026', 'HLT_DoubleJetsC100_SingleBTagCSV_p014', 'HLT_DoubleJetsC100_SingleBTagCSV_p026_SinglePFJetC350', 'HLT_DoubleJetsC100_SingleBTagCSV_p014_SinglePFJetC350', 'HLT_Photon135_PFMET100', 'HLT_Photon20_CaloIdVL_IsoL', 'HLT_Photon22_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon22_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Photon250_NoHE', 'HLT_Photon300_NoHE', 'HLT_Photon26_R9Id85_OR_CaloId24b40e_Iso50T80L_Photon16_AND_HE10_R9Id65_Eta2_Mass60', 'HLT_Photon36_R9Id85_OR_CaloId24b40e_Iso50T80L_Photon22_AND_HE10_R9Id65_Eta2_Mass15', 'HLT_Photon36_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon36_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Photon50_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon50_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Photon75_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon75_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Photon90_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon90_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Photon120_R9Id90_HE10_Iso40_EBOnly_PFMET40', 'HLT_Photon120_R9Id90_HE10_Iso40_EBOnly_VBF', 'HLT_Mu8_TrkIsoVVL', 'HLT_Mu17_TrkIsoVVL', 'HLT_Ele8_CaloIdL_TrackIdL_IsoVL_PFJet30', 'HLT_Ele12_CaloIdL_TrackIdL_IsoVL_PFJet30', 'HLT_Ele17_CaloIdL_TrackIdL_IsoVL_PFJet30', 'HLT_Ele23_CaloIdL_TrackIdL_IsoVL_PFJet30', 'HLT_BTagMu_DiJet20_Mu5', 'HLT_BTagMu_DiJet40_Mu5', 'HLT_BTagMu_DiJet70_Mu5', 'HLT_BTagMu_DiJet110_Mu5', 'HLT_BTagMu_DiJet170_Mu5', 'HLT_BTagMu_Jet300_Mu5', 'HLT_BTagMu_AK8Jet300_Mu5', 'HLT_Ele23_Ele12_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Ele23_Ele12_CaloIdL_TrackIdL_IsoVL_DZ_L1JetTauSeeded', 'HLT_Ele17_Ele12_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Ele16_Ele12_Ele8_CaloIdL_TrackIdL', 'HLT_Mu8_TrkIsoVVL_Ele17_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Mu12_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu12_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Mu17_TrkIsoVVL_Ele12_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu23_TrkIsoVVL_Ele8_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu23_TrkIsoVVL_Ele8_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Mu23_TrkIsoVVL_Ele12_CaloIdL_TrackIdL_IsoVL', 'HLT_Mu23_TrkIsoVVL_Ele12_CaloIdL_TrackIdL_IsoVL_DZ', 'HLT_Mu30_Ele30_CaloIdL_GsfTrkIdVL', 'HLT_Mu33_Ele33_CaloIdL_GsfTrkIdVL', 'HLT_Mu37_Ele27_CaloIdL_GsfTrkIdVL', 'HLT_Mu27_Ele37_CaloIdL_GsfTrkIdVL', 'HLT_Mu8_DiEle12_CaloIdL_TrackIdL', 'HLT_Mu12_Photon25_CaloIdL', 'HLT_Mu12_Photon25_CaloIdL_L1ISO', 'HLT_Mu12_Photon25_CaloIdL_L1OR', 'HLT_Mu17_Photon22_CaloIdL_L1ISO', 'HLT_Mu17_Photon30_CaloIdL_L1ISO', 'HLT_Mu17_Photon35_CaloIdL_L1ISO', 'HLT_DiMu9_Ele9_CaloIdL_TrackIdL', 'HLT_TripleMu_5_3_3', 'HLT_TripleMu_12_10_5', 'HLT_Mu3er_PFHT140_PFMET125', 'HLT_Mu6_PFHT200_PFMET80_BTagCSV_p067', 'HLT_Mu6_PFHT200_PFMET100', 'HLT_Mu14er_PFMET100', 'HLT_Ele17_Ele12_CaloIdL_TrackIdL_IsoVL', 'HLT_Ele23_Ele12_CaloIdL_TrackIdL_IsoVL', 'HLT_Ele12_CaloIdL_TrackIdL_IsoVL', 'HLT_Ele17_CaloIdL_GsfTrkIdVL', 'HLT_Ele17_CaloIdL_TrackIdL_IsoVL', 'HLT_Ele23_CaloIdL_TrackIdL_IsoVL', 'HLT_PFHT650_WideJetMJJ900DEtaJJ1p5', 'HLT_PFHT650_WideJetMJJ950DEtaJJ1p5', 'HLT_Photon22', 'HLT_Photon30', 'HLT_Photon36', 'HLT_Photon50', 'HLT_Photon75', 'HLT_Photon90', 'HLT_Photon120', 'HLT_Photon175', 'HLT_Photon165_HE10', 'HLT_Photon22_R9Id90_HE10_IsoM', 'HLT_Photon30_R9Id90_HE10_IsoM', 'HLT_Photon36_R9Id90_HE10_IsoM', 'HLT_Photon50_R9Id90_HE10_IsoM', 'HLT_Photon75_R9Id90_HE10_IsoM', 'HLT_Photon90_R9Id90_HE10_IsoM', 'HLT_Photon120_R9Id90_HE10_IsoM', 'HLT_Photon165_R9Id90_HE10_IsoM', 'HLT_Diphoton30_18_R9Id_OR_IsoCaloId_AND_HE_R9Id_Mass90', 'HLT_Diphoton30_18_R9Id_OR_IsoCaloId_AND_HE_R9Id_DoublePixelSeedMatch_Mass70', 'HLT_Diphoton30PV_18PV_R9Id_AND_IsoCaloId_AND_HE_R9Id_DoublePixelVeto_Mass55', 'HLT_Diphoton30_18_Solid_R9Id_AND_IsoCaloId_AND_HE_R9Id_Mass55', 'HLT_Diphoton30EB_18EB_R9Id_OR_IsoCaloId_AND_HE_R9Id_DoublePixelVeto_Mass55', 'HLT_Dimuon0_Jpsi_Muon', 'HLT_Dimuon0_Upsilon_Muon', 'HLT_QuadMuon0_Dimuon0_Jpsi', 'HLT_QuadMuon0_Dimuon0_Upsilon', 'HLT_Rsq0p25_Calo', 'HLT_RsqMR240_Rsq0p09_MR200_4jet_Calo', 'HLT_RsqMR240_Rsq0p09_MR200_Calo', 'HLT_Rsq0p25', 'HLT_Rsq0p30', 'HLT_RsqMR240_Rsq0p09_MR200', 'HLT_RsqMR240_Rsq0p09_MR200_4jet', 'HLT_RsqMR270_Rsq0p09_MR200', 'HLT_RsqMR270_Rsq0p09_MR200_4jet', 'HLT_Rsq0p02_MR300_TriPFJet80_60_40_BTagCSV_p063_p20_Mbb60_200', 'HLT_Rsq0p02_MR400_TriPFJet80_60_40_DoubleBTagCSV_p063_Mbb60_200', 'HLT_Rsq0p02_MR450_TriPFJet80_60_40_DoubleBTagCSV_p063_Mbb60_200', 'HLT_Rsq0p02_MR500_TriPFJet80_60_40_DoubleBTagCSV_p063_Mbb60_200', 'HLT_Rsq0p02_MR550_TriPFJet80_60_40_DoubleBTagCSV_p063_Mbb60_200', 'HLT_HT200_DisplacedDijet40_DisplacedTrack', 'HLT_HT250_DisplacedDijet40_DisplacedTrack', 'HLT_HT350_DisplacedDijet40_DisplacedTrack', 'HLT_HT350_DisplacedDijet80_DisplacedTrack', 'HLT_HT350_DisplacedDijet80_Tight_DisplacedTrack', 'HLT_HT350_DisplacedDijet40_Inclusive', 'HLT_HT400_DisplacedDijet40_Inclusive', 'HLT_HT500_DisplacedDijet40_Inclusive', 'HLT_HT550_DisplacedDijet40_Inclusive', 'HLT_HT550_DisplacedDijet80_Inclusive', 'HLT_HT650_DisplacedDijet80_Inclusive', 'HLT_HT750_DisplacedDijet80_Inclusive', 'HLT_VBF_DisplacedJet40_DisplacedTrack', 'HLT_VBF_DisplacedJet40_DisplacedTrack_2TrackIP2DSig5', 'HLT_VBF_DisplacedJet40_TightID_DisplacedTrack', 'HLT_VBF_DisplacedJet40_Hadronic', 'HLT_VBF_DisplacedJet40_Hadronic_2PromptTrack', 'HLT_VBF_DisplacedJet40_TightID_Hadronic', 'HLT_VBF_DisplacedJet40_VTightID_Hadronic', 'HLT_VBF_DisplacedJet40_VVTightID_Hadronic', 'HLT_VBF_DisplacedJet40_VTightID_DisplacedTrack', 'HLT_VBF_DisplacedJet40_VVTightID_DisplacedTrack', 'HLT_PFMETNoMu90_PFMHTNoMu90_IDTight', 'HLT_PFMETNoMu100_PFMHTNoMu100_IDTight', 'HLT_PFMETNoMu110_PFMHTNoMu110_IDTight', 'HLT_PFMETNoMu120_PFMHTNoMu120_IDTight', 'HLT_MonoCentralPFJet80_PFMETNoMu90_PFMHTNoMu90_IDTight', 'HLT_MonoCentralPFJet80_PFMETNoMu100_PFMHTNoMu100_IDTight', 'HLT_MonoCentralPFJet80_PFMETNoMu110_PFMHTNoMu110_IDTight', 'HLT_MonoCentralPFJet80_PFMETNoMu120_PFMHTNoMu120_IDTight', 'HLT_Ele27_eta2p1_WPLoose_Gsf_HT200', 'HLT_Photon90_CaloIdL_PFHT500', 'HLT_DoubleMu8_Mass8_PFHT250', 'HLT_Mu8_Ele8_CaloIdM_TrackIdM_Mass8_PFHT250', 'HLT_DoubleEle8_CaloIdM_TrackIdM_Mass8_PFHT250', 'HLT_DoubleMu8_Mass8_PFHT300', 'HLT_Mu8_Ele8_CaloIdM_TrackIdM_Mass8_PFHT300', 'HLT_DoubleEle8_CaloIdM_TrackIdM_Mass8_PFHT300', 'HLT_Mu10_CentralPFJet30_BTagCSV_p13', 'HLT_DoubleMu3_PFMET50', 'HLT_Ele10_CaloIdM_TrackIdM_CentralPFJet30_BTagCSV_p13', 'HLT_Ele15_IsoVVVL_BTagCSV_p067_PFHT400', 'HLT_Ele15_IsoVVVL_PFHT350_PFMET50', 'HLT_Ele15_IsoVVVL_PFHT600', 'HLT_Ele15_IsoVVVL_PFHT350', 'HLT_Ele15_IsoVVVL_PFHT400_PFMET50', 'HLT_Ele15_IsoVVVL_PFHT400', 'HLT_Ele50_IsoVVVL_PFHT400', 'HLT_Mu8_TrkIsoVVL_DiPFJet40_DEta3p5_MJJ750_HTT300_PFMETNoMu60', 'HLT_Mu10_TrkIsoVVL_DiPFJet40_DEta3p5_MJJ750_HTT350_PFMETNoMu60', 'HLT_Mu15_IsoVVVL_BTagCSV_p067_PFHT400', 'HLT_Mu15_IsoVVVL_PFHT350_PFMET50', 'HLT_Mu15_IsoVVVL_PFHT600', 'HLT_Mu15_IsoVVVL_PFHT350', 'HLT_Mu15_IsoVVVL_PFHT400_PFMET50', 'HLT_Mu15_IsoVVVL_PFHT400', 'HLT_Mu50_IsoVVVL_PFHT400', 'HLT_Dimuon16_Jpsi', 'HLT_Dimuon10_Jpsi_Barrel', 'HLT_Dimuon8_PsiPrime_Barrel', 'HLT_Dimuon8_Upsilon_Barrel', 'HLT_Dimuon0_Phi_Barrel', 'HLT_Mu16_TkMu0_dEta18_Onia', 'HLT_Mu16_TkMu0_dEta18_Phi', 'HLT_TrkMu15_DoubleTrkMu5NoFiltersNoVtx', 'HLT_TrkMu17_DoubleTrkMu8NoFiltersNoVtx', 'HLT_Mu8', 'HLT_Mu17', 'HLT_Mu3_PFJet40', 'HLT_Ele8_CaloIdM_TrackIdM_PFJet30', 'HLT_Ele12_CaloIdM_TrackIdM_PFJet30', 'HLT_Ele17_CaloIdM_TrackIdM_PFJet30', 'HLT_Ele23_CaloIdM_TrackIdM_PFJet30', 'HLT_Ele50_CaloIdVT_GsfTrkIdT_PFJet140', 'HLT_Ele50_CaloIdVT_GsfTrkIdT_PFJet165', 'HLT_PFHT400_SixJet30_DoubleBTagCSV_p056', 'HLT_PFHT450_SixJet40_BTagCSV_p056', 'HLT_PFHT400_SixJet30', 'HLT_PFHT450_SixJet40', 'HLT_Ele115_CaloIdVT_GsfTrkIdT', 'HLT_Mu55', 'HLT_Photon42_R9Id85_OR_CaloId24b40e_Iso50T80L_Photon25_AND_HE10_R9Id65_Eta2_Mass15', 'HLT_Photon90_CaloIdL_PFHT600', 'HLT_PixelTracks_Multiplicity60ForEndOfFill', 'HLT_PixelTracks_Multiplicity85ForEndOfFill', 'HLT_PixelTracks_Multiplicity110ForEndOfFill', 'HLT_PixelTracks_Multiplicity135ForEndOfFill', 'HLT_PixelTracks_Multiplicity160ForEndOfFill', 'HLT_FullTracks_Multiplicity80', 'HLT_FullTracks_Multiplicity100', 'HLT_FullTracks_Multiplicity130', 'HLT_FullTracks_Multiplicity150', 'HLT_ECALHT800', 'HLT_DiSC30_18_EIso_AND_HE_Mass70', 'HLT_Photon125', 'HLT_MET100', 'HLT_MET150', 'HLT_MET200', 'HLT_Ele27_HighEta_Ele20_Mass55', 'HLT_L1FatEvents', 'HLT_Physics', 'HLT_L1FatEvents_part0', 'HLT_L1FatEvents_part1', 'HLT_L1FatEvents_part2', 'HLT_L1FatEvents_part3', 'HLT_Random', 'HLT_ZeroBias', 'HLT_AK4CaloJet30', 'HLT_AK4CaloJet40', 'HLT_AK4CaloJet50', 'HLT_AK4CaloJet80', 'HLT_AK4CaloJet100', 'HLT_AK4PFJet30', 'HLT_AK4PFJet50', 'HLT_AK4PFJet80', 'HLT_AK4PFJet100', 'HLT_HISinglePhoton10', 'HLT_HISinglePhoton15', 'HLT_HISinglePhoton20', 'HLT_HISinglePhoton40', 'HLT_HISinglePhoton60', 'HLT_EcalCalibration', 'HLT_HcalCalibration', 'HLT_GlobalRunHPDNoise', 'HLT_L1BptxMinus', 'HLT_L1BptxPlus', 'HLT_L1NotBptxOR', 'HLT_L1BeamGasMinus', 'HLT_L1BeamGasPlus', 'HLT_L1BptxXOR', 'HLT_L1MinimumBiasHF_OR', 'HLT_L1MinimumBiasHF_AND', 'HLT_HcalNZS', 'HLT_HcalPhiSym', 'HLT_HcalIsolatedbunch', 'HLT_ZeroBias_FirstCollisionAfterAbortGap', 'HLT_ZeroBias_FirstCollisionAfterAbortGap_copy', 'HLT_ZeroBias_FirstCollisionAfterAbortGap_TCDS', 'HLT_ZeroBias_IsolatedBunches', 'HLT_ZeroBias_FirstCollisionInTrain', 'HLT_ZeroBias_FirstBXAfterTrain', 'HLT_Photon500', 'HLT_Photon600', 'HLT_Mu300', 'HLT_Mu350', 'HLT_MET250', 'HLT_MET300', 'HLT_MET600', 'HLT_MET700', 'HLT_PFMET300', 'HLT_PFMET400', 'HLT_PFMET500', 'HLT_PFMET600', 'HLT_Ele250_CaloIdVT_GsfTrkIdT', 'HLT_Ele300_CaloIdVT_GsfTrkIdT', 'HLT_HT2000', 'HLT_HT2500', 'HLT_IsoTrackHE', 'HLT_IsoTrackHB', 'HLTriggerFinalPath', 'L1simulation_step']
</code></pre>
<p>Using the <code>pretty_print</code> function we can get a formatted version of the keys.</p>
<pre><code class="language-python">#### Pretty print all the keys with the default format

#pretty_print(events.keys())

#### Pretty print keys with 30 characters per column, for keys that contain `FatJet`
#pretty_print(events.keys(), fmt='30s', require='FatJet')

#### Pretty print keys with 40 characters per column, for keys that contain `Muon` and `Iso` but ignore ones with `HLT`
pretty_print(events.keys(), fmt='40s', require=['Muon', 'Iso'], ignore='HLT')
</code></pre>
<pre><code>Muon_jetRelIso                           Muon_miniPFRelIso_all                    
Muon_miniPFRelIso_chg                    Muon_pfRelIso03_all                      
Muon_pfRelIso03_chg                      Muon_pfRelIso04_all                      
Muon_tkRelIso                            Muon_miniIsoId                           
Muon_multiIsoId                          Muon_pfIsoId                             
Muon_puppiIsoId                          Muon_tkIsoId
</code></pre>
<h2 id="extracting-data">Extracting data</h2>
<p>We will extract subsets of data from the files to do our analysis.</p>
<p>You can find a list of the variable names in each dataset on the CERN Open Data Portal page for that dataset, for example, <a href="https://opendata.cern.ch/eos/opendata/cms/dataset-semantics/NanoAODSIM/75156/ZprimeToTT_M2000_W20_TuneCP2_PSweights_13TeV-madgraph-pythiaMLM-pythia8_doc.html">here</a>.</p>
<p>We will work with the next sets of variables:
* <code>Jet</code> for non-merged jets
* <code>Muon</code> for muons
* <code>Electron</code> for electrons
* <code>MET</code> for the missing energy in the transverse plane</p>
<p>In addition we will use some <code>Triggers</code> from the dataset.</p>
<pre><code class="language-python"># -------------------------------
# Jets
# -------------------------------
jet_btag = events['Jet_btagDeepB'].array()
jet_jetid = events['Jet_jetId'].array()
jet_pt = events['Jet_pt'].array()
jet_eta = events['Jet_eta'].array()
jet_phi = events['Jet_phi'].array()
jet_mass = events['Jet_mass'].array()

# -------------------------------
# Electrons
# -------------------------------
electron_pt = events['Electron_pt'].array()
electron_eta = events['Electron_eta'].array()
electron_phi = events['Electron_phi'].array()
electron_mass = events['Electron_mass'].array()
electron_cutB = events['Electron_cutBased'].array()

# -------------------------------
# Muons
# -------------------------------
muon_pt = events['Muon_pt'].array()
muon_eta = events['Muon_eta'].array()
muon_phi = events['Muon_phi'].array()
muon_mass = events['Muon_mass'].array()
muon_loose = events['Muon_looseId'].array()
muon_iso = events['Muon_pfRelIso04_all'].array()

# -------------------------------
# MET
# -------------------------------
met_pt = events['MET_pt'].array()
met_eta = 0 * events['MET_pt'].array()
met_phi = events['MET_phi'].array()

</code></pre>
<h2 id="applying-cuts">Applying cuts</h2>
<p>The first step to analyze the data is to select the filters that we are going to apply in it. In order to separate the two possibilities in the single lepton channel, we create a <code>CONFIG</code> dictionary to save the parameters that muons and electrons must pass to count them in the single lepton channel.</p>
<p>In addition, we save other parameters shared with the all-hadronic channel.</p>
<h3 id="single-lepton-event-selection-why-these-cuts">Single-Lepton Event Selection: Why These Cuts?</h3>
<p>When analyzing single-lepton events (muon or electron) for dark matter searches, the goal is to <strong>maximize sensitivity to potential signals</strong> while <strong>suppressing Standard Model backgrounds</strong> like <span class="arithmatex">\(t\bar{t}\)</span>, W+jets, and QCD multijet events. Each selection criterion has a clear purpose:</p>
<h3 id="signal-lepton-selection">Signal Lepton Selection</h3>
<ul>
<li><strong>Exactly one isolated lepton</strong> (muon or electron).  </li>
<li>Kinematic requirements ensure the lepton is well-reconstructed and on the <strong>trigger plateau</strong>:</li>
<li>Muons: <span class="arithmatex">\(p_T &gt; 26~\text{GeV}\)</span>, <span class="arithmatex">\(|\eta| &lt; 2.4\)</span>, Tight ID, relative isolation &lt; 0.15.  </li>
<li>Electrons: <span class="arithmatex">\(p_T &gt; 30~\text{GeV}\)</span>, <span class="arithmatex">\(|\eta| &lt; 2.5\)</span>, Tight ID, avoid ECAL crack.  </li>
<li><strong>Reason:</strong> We want a clean, genuine lepton to identify the event topology reliably.</li>
</ul>
<h3 id="jets-and-b-jets">Jets and b-Jets</h3>
<ul>
<li><strong>At least 2 jets</strong>, with <strong>at least 1 b-tagged</strong>.</li>
<li>Criteria: <span class="arithmatex">\(p_T &gt; 30~\text{GeV}\)</span>, <span class="arithmatex">\(|\eta| &lt; 2.4\)</span>, Jet ID ≥ Tight, DeepCSV medium b-tag.</li>
<li><strong>Reasoning:</strong> Top quarks produce b-jets; this suppresses W+light-flavor jets and enhances top+MET purity.</li>
</ul>
<h3 id="kinematic-variables">Kinematic Variables</h3>
<ul>
<li><strong>Missing Transverse Energy (MET) &gt; 160 GeV</strong>  </li>
<li>Dark matter escapes undetected → large MET.  </li>
<li><strong>Transverse Mass (MT) &gt; 160 GeV</strong>  </li>
<li>Reduces W+jets background, which peaks near <span class="arithmatex">\(M_W\)</span>.  </li>
<li><strong>Azimuthal separation Δφ(j1,2, MET) &gt; 1.2</strong>  </li>
<li>Reduces QCD multijet events with fake MET aligned to jets.  </li>
<li><strong>b–MET transverse mass MT(b, MET) &gt; 180 GeV</strong>  </li>
<li>Further discriminates signal from <span class="arithmatex">\(t\bar{t}\)</span> events.</li>
</ul>
<pre><code class="language-python"># -------------------------------
# Single-lepton selection configs
# -------------------------------

CONFIG = {
    &quot;muon&quot;: {
        # Selected lepton (muon)
        &quot;MU_PT_MIN&quot;: 26.0,        # pT ≥ 26 GeV (HLT_IsoMu24 turn-on)
        &quot;MU_ETA_MAX&quot;: 2.4,
        &quot;MU_TIGHT_ID&quot;: 1,         # tightId == True
        &quot;MU_ISO_MAX&quot;: 0.15,       # relative isolation &lt; 0.15

        # Veto lepton (electron)
        &quot;EL_PT_MIN&quot;: 15.0,
        &quot;EL_ETA_MAX&quot;: 2.5,
        &quot;EL_CUTBASED_MIN&quot;:1,     # cutBased ≥ Loose
        &quot;EL_VETO_ECAL_CRACK&quot;: False,  # you can set True later
    },

    &quot;electron&quot;: {
        # Selected lepton (electron)
        &quot;EL_PT_MIN&quot;: 30.0,        # pT ≥ 30 GeV (HLT_Ele27_WPTight)
        &quot;EL_ETA_MAX&quot;: 2.5,
        &quot;EL_CUTBASED_MIN&quot;: 4,     # cutBased ≥ Tight
        &quot;EL_VETO_ECAL_CRACK&quot;: True,  # 1.4442&lt;|etaSC|&lt;1.566

        # Veto lepton (muon)
        &quot;MU_PT_MIN&quot;: 10.0,
        &quot;MU_ETA_MAX&quot;: 2.4,
        &quot;MU_LOOSE_ID&quot;: 1,         # looseId == True
        &quot;MU_ISO_MAX&quot;: 0.25,
    }
}

# -------------------------------
# Common (channel-independent)
# -------------------------------
JET_PT_MIN   = 30.0
JET_ETA_MAX  = 2.4
JET_ID_MIN   = 2           # 2 = tight, 6 = tightLepVeto
BTAG_WP_MED  = 0.632       # DeepCSV medium (UL2016)
FWD_PT_MIN   = 30.0
FWD_ABS_ETA_MIN = 2.5
FWD_ABS_ETA_MAX = 4.7
DR_LEP_JET   = 0.4

MIN_NJETS    = 2
MIN_NBTAGS   = 1

MET_MIN      = 40.0
MT_MIN       = 50.0          # mT(W) &gt; 50 GeV
MT_B_MET_MIN = 160.0         # mT(b, MET) &gt; 160 GeV  (typical DM analysis cut)
DPHI_J12_MET_MIN = 0.4       # min Δφ(j1/2, MET) &gt; 0.4

MT_MIN       = 50.0

</code></pre>
<p>Using jets as an example, we can create a filter the common parameters:</p>
<pre><code class="language-python">cut_jet = (abs(jet_eta) &lt; JET_ETA_MAX) &amp; (jet_pt &gt; JET_PT_MIN) &amp; ( jet_jetid &gt;= JET_ID_MIN)
print(cut_jet)

</code></pre>
<pre><code>[[True, True, False, True, True, False], ..., [True, True, ..., False, False]]
</code></pre>
<p>We can see that the <code>cut_jet</code> cut is an array of <code>True</code> and <code>False</code> that will filter the events.</p>
<p>Let's see how this works</p>
<pre><code class="language-python">print(&quot;Jet pt without cuts&quot;)
print(jet_pt)
print(&quot;-----------&quot;)
print(&quot;Jet pt after cuts&quot;)
print(jet_pt[cut_jet])
</code></pre>
<pre><code>Jet pt without cuts
[[81.5, 79.1, 61.2, 49, 34.3, 16.5], ..., [173, 75.4, 54.5, ..., 28.3, 18]]
-----------
Jet pt after cuts
[[81.5, 79.1, 49, 34.3], [125, ...], ..., [173, 75.4, 54.5, 53.9, 37.9, 36.2]]
</code></pre>
<p>Let's select the <code>electron</code> channel and create the cuts</p>
<pre><code class="language-python">channel = &quot;electron&quot;
cfg = CONFIG[channel]
</code></pre>
<pre><code class="language-python"># -------------------------------
# Lepton selections
# -------------------------------
cut_electron = (
            (electron_pt &gt; cfg[&quot;EL_PT_MIN&quot;]) &amp;
            (abs(electron_eta) &lt; cfg[&quot;EL_ETA_MAX&quot;]) &amp;
            (electron_cutB &gt;= cfg[&quot;EL_CUTBASED_MIN&quot;])
        )
cut_one_lepton = (ak.num(electron_pt[cut_electron]) == 1)

cut_mu_veto = (
            (muon_pt &gt; cfg[&quot;MU_PT_MIN&quot;]) &amp;
            (abs(muon_eta) &lt; cfg[&quot;MU_ETA_MAX&quot;]) &amp;
            (muon_loose == cfg[&quot;MU_LOOSE_ID&quot;]) &amp;
            (muon_iso &lt; cfg[&quot;MU_ISO_MAX&quot;])
        )
cut_no_other = (ak.num(muon_pt[cut_mu_veto]) == 0)

lep_pt_single = electron_pt[:,:1]
lep_phi_single = electron_phi[:,:1]
</code></pre>
<pre><code class="language-python"># Other filters:
# --- Math utilities ---
def delta_phi(phi1, phi2):
    dphi = phi1 - phi2
    dphi = (dphi + np.pi) % (2*np.pi) - np.pi
    return np.abs(dphi)

def transverse_mass(pt1, phi1, pt2, phi2):
    dphi = delta_phi(phi1, phi2)
    return np.sqrt(2 * pt1 * pt2 * (1 - np.cos(dphi)))
</code></pre>
<p>Both functions above calculate the diference in the phi angle and the transverse mass of the event respectively.</p>
<pre><code class="language-python"># -------------------------------
# Jets / forward jets
# -------------------------------
cut_jet = (abs(jet_eta) &lt; JET_ETA_MAX) &amp; (jet_pt &gt; JET_PT_MIN) &amp; (jet_jetid &gt;= JET_ID_MIN)
cut_nj = ak.num(jet_pt[cut_jet]) &gt;= MIN_NJETS
cut_bjet = (jet_btag &gt; BTAG_WP_MED)
cut_fj = (
        (jet_pt &gt; FWD_PT_MIN) &amp;
        (abs(jet_eta) &gt; FWD_ABS_ETA_MIN) &amp;
        (abs(jet_eta) &lt; FWD_ABS_ETA_MAX) &amp;
        (jet_jetid &gt;= JET_ID_MIN)
    )

# -------------------------------
# Special kinematics
# -------------------------------
mT = transverse_mass(lep_pt_single, lep_phi_single, met_pt, met_phi)
cut_mtw = ak.fill_none(ak.firsts(mT &gt; MT_MIN), False)

best_bjet_idx = ak.argmax(jet_btag, axis=1, keepdims=True)
best_bjet_pt = jet_pt[best_bjet_idx]
best_bjet_phi = jet_phi[best_bjet_idx]
mTb = transverse_mass(ak.flatten(best_bjet_pt), ak.flatten(best_bjet_phi), met_pt, met_phi)

jet1_phi = jet_phi[:, :1]
jet2_phi = jet_phi[:, 1:2]
dphi_j1 = delta_phi(jet1_phi, met_phi)
dphi_j2 = delta_phi(jet2_phi, met_phi)
min_dphi = ak.min(ak.concatenate([dphi_j1[:, None], dphi_j2[:, None]], axis=1), axis=1)

cut_mtb = mTb &gt; MT_B_MET_MIN
cut_dphi = ak.fill_none(ak.firsts(min_dphi &gt; DPHI_J12_MET_MIN), False)
cut_esp = cut_mtw &amp; cut_mtb &amp; cut_dphi

# -------------------------------
# Event-level cuts
# -------------------------------
cut_met = (met_pt &gt; MET_MIN)
cut_base = cut_nj &amp; cut_one_lepton &amp; cut_no_other &amp; cut_met &amp; cut_esp

cut_1b = ak.count(jet_pt[cut_bjet], axis=1) == 1
cut_0fj = ak.num(jet_pt[cut_fj]) == 0
cut1 = cut_base &amp; cut_1b &amp; cut_0fj

cut_full_event = cut1
</code></pre>
<h2 id="building-output-objects">Building output objects</h2>
<p>Using the
<a href="https://vector.readthedocs.io/en/latest/">Vector class</a>
and the akward library we will create 4-vector objects.</p>
<pre><code class="language-python"># -------------------------------
# Build output objects
# -------------------------------
met = ak.zip(
        {&quot;pt&quot;: met_pt[cut_full_event],
         &quot;eta&quot;: met_eta[cut_full_event],
         &quot;phi&quot;: met_phi[cut_full_event],
         &quot;mass&quot;: 0},
        with_name=&quot;Momentum4D&quot;,
    )

if channel == &quot;muon&quot;:
    lep = ak.zip(
            {&quot;pt&quot;: muon_pt[cut_full_event][cut_muon[cut_full_event]],
             &quot;eta&quot;: muon_eta[cut_full_event][cut_muon[cut_full_event]],
             &quot;phi&quot;: muon_phi[cut_full_event][cut_muon[cut_full_event]],
             &quot;mass&quot;: muon_mass[cut_full_event][cut_muon[cut_full_event]]},
            with_name=&quot;Momentum4D&quot;,
        )
else:
    lep = ak.zip(
            {&quot;pt&quot;: electron_pt[cut_full_event][cut_electron[cut_full_event]],
             &quot;eta&quot;: electron_eta[cut_full_event][cut_electron[cut_full_event]],
             &quot;phi&quot;: electron_phi[cut_full_event][cut_electron[cut_full_event]],
             &quot;mass&quot;: electron_mass[cut_full_event][cut_electron[cut_full_event]]},
            with_name=&quot;Momentum4D&quot;,
        )

</code></pre>
<p>Let's plot the lepton (electron) momentum.</p>
<pre><code class="language-python">x = lep.pt

# Plot it!
plt.hist(ak.flatten(x,axis=None), bins=100, range=(0,500))
plt.xlabel(f'$p_{{T}}$ $GeV$', fontsize=18)
plt.tight_layout()
</code></pre>
<p><img alt="png" src="../output_48_0.png" /></p>
<h2 id="processing-the-files">Processing the files</h2>
<p>From what we showed you above, we define a <code>process_file</code> function to process the files.</p>
<p>The first thing it does is open the ROOT file from the files we made at the beginning. If theres no problem it prints the number of events in the file.</p>
<p>Then it loads the configuration that we selected above and access the required information in the dataset, for example the B-tagging variable <code>Jet_btagDeepB</code>.</p>
<p>According to the specified <code>channel</code> it applies the parameters for muons or electrons. Then it applies the cuts for the events, for instance filtering the transverse mass of the event.</p>
<p>After that we save the object we are interested in, in this case the MET of the event, using the <code>akward</code> library.</p>
<pre><code class="language-python"># ==========================================================
# Generic processing function with channel support
# ==========================================================
def process_file(filename, dataset='default', channel='muon', IS_DATA=False):
    print(f&quot;Opening...{filename}&quot;)
    try:
        f = uproot.open(filename)
    except:
        print(f&quot;Could not open {filename}&quot;)
        return None

    events = f['Events']
    nevents = events.num_entries
    print(f&quot;{nevents = }&quot;)

    # -------------------------------
    # Load channel-specific config
    # -------------------------------
    cfg = CONFIG[channel]

    # -------------------------------
    # Jets
    # -------------------------------
    jet_btag = events['Jet_btagDeepB'].array()
    jet_jetid = events['Jet_jetId'].array()
    jet_pt = events['Jet_pt'].array()
    jet_eta = events['Jet_eta'].array()
    jet_phi = events['Jet_phi'].array()
    jet_mass = events['Jet_mass'].array()

    # -------------------------------
    # Electrons
    # -------------------------------
    electron_pt = events['Electron_pt'].array()
    electron_eta = events['Electron_eta'].array()
    electron_phi = events['Electron_phi'].array()
    electron_mass = events['Electron_mass'].array()
    electron_cutB = events['Electron_cutBased'].array()

    # -------------------------------
    # Muons
    # -------------------------------
    muon_pt = events['Muon_pt'].array()
    muon_eta = events['Muon_eta'].array()
    muon_phi = events['Muon_phi'].array()
    muon_mass = events['Muon_mass'].array()
    muon_loose = events['Muon_looseId'].array()
    muon_iso = events['Muon_pfRelIso04_all'].array()

    # -------------------------------
    # MET
    # -------------------------------
    met_pt = events['MET_pt'].array()
    met_eta = 0 * events['MET_pt'].array()
    met_phi = events['MET_phi'].array()

    # -------------------------------
    # Lepton selections
    # -------------------------------
    if channel == &quot;muon&quot;:
        cut_muon = (
            (muon_pt &gt; cfg[&quot;MU_PT_MIN&quot;]) &amp;
            (abs(muon_eta) &lt; cfg[&quot;MU_ETA_MAX&quot;]) &amp;
            (events['Muon_tightId'].array() == cfg[&quot;MU_TIGHT_ID&quot;]) &amp;
            (muon_iso &lt; cfg[&quot;MU_ISO_MAX&quot;])
        )
        cut_one_lepton = (ak.num(muon_pt[cut_muon]) == 1)

        cut_e_veto = (
            (electron_pt &gt; cfg[&quot;EL_PT_MIN&quot;]) &amp;
            (abs(electron_eta) &lt; cfg[&quot;EL_ETA_MAX&quot;]) &amp;
            (electron_cutB &gt;= cfg[&quot;EL_CUTBASED_MIN&quot;])
        )
        cut_no_other = (ak.num(electron_pt[cut_e_veto]) == 0)

        lep_pt_single = muon_pt[:,:1]
        lep_phi_single = muon_phi[:,:1]

    elif channel == &quot;electron&quot;:
        cut_electron = (
            (electron_pt &gt; cfg[&quot;EL_PT_MIN&quot;]) &amp;
            (abs(electron_eta) &lt; cfg[&quot;EL_ETA_MAX&quot;]) &amp;
            (electron_cutB &gt;= cfg[&quot;EL_CUTBASED_MIN&quot;])
        )
        cut_one_lepton = (ak.num(electron_pt[cut_electron]) == 1)

        cut_mu_veto = (
            (muon_pt &gt; cfg[&quot;MU_PT_MIN&quot;]) &amp;
            (abs(muon_eta) &lt; cfg[&quot;MU_ETA_MAX&quot;]) &amp;
            (muon_loose == cfg[&quot;MU_LOOSE_ID&quot;]) &amp;
            (muon_iso &lt; cfg[&quot;MU_ISO_MAX&quot;])
        )
        cut_no_other = (ak.num(muon_pt[cut_mu_veto]) == 0)

        lep_pt_single = electron_pt[:,:1]
        lep_phi_single = electron_phi[:,:1]

    # -------------------------------
    # Jets / forward jets
    # -------------------------------
    cut_jet = (abs(jet_eta) &lt; JET_ETA_MAX) &amp; (jet_pt &gt; JET_PT_MIN) &amp; (jet_jetid &gt;= JET_ID_MIN)
    cut_nj = ak.num(jet_pt[cut_jet]) &gt;= MIN_NJETS
    cut_bjet = (jet_btag &gt; BTAG_WP_MED)
    cut_fj = (
        (jet_pt &gt; FWD_PT_MIN) &amp;
        (abs(jet_eta) &gt; FWD_ABS_ETA_MIN) &amp;
        (abs(jet_eta) &lt; FWD_ABS_ETA_MAX) &amp;
        (jet_jetid &gt;= JET_ID_MIN)
    )

    # -------------------------------
    # Special kinematics
    # -------------------------------
    mT = transverse_mass(lep_pt_single, lep_phi_single, met_pt, met_phi)
    cut_mtw = ak.fill_none(ak.firsts(mT &gt; MT_MIN), False)

    best_bjet_idx = ak.argmax(jet_btag, axis=1, keepdims=True)
    best_bjet_pt = jet_pt[best_bjet_idx]
    best_bjet_phi = jet_phi[best_bjet_idx]
    mTb = transverse_mass(ak.flatten(best_bjet_pt), ak.flatten(best_bjet_phi), met_pt, met_phi)

    jet1_phi = jet_phi[:, :1]
    jet2_phi = jet_phi[:, 1:2]
    dphi_j1 = delta_phi(jet1_phi, met_phi)
    dphi_j2 = delta_phi(jet2_phi, met_phi)
    min_dphi = ak.min(ak.concatenate([dphi_j1[:, None], dphi_j2[:, None]], axis=1), axis=1)

    cut_mtb = mTb &gt; MT_B_MET_MIN
    cut_dphi = ak.fill_none(ak.firsts(min_dphi &gt; DPHI_J12_MET_MIN), False)
    cut_esp = cut_mtw &amp; cut_mtb &amp; cut_dphi

    # -------------------------------
    # Event-level cuts
    # -------------------------------
    cut_met = (met_pt &gt; MET_MIN)
    cut_base = cut_nj &amp; cut_one_lepton &amp; cut_no_other &amp; cut_met &amp; cut_esp

    cut_1b = ak.count(jet_pt[cut_bjet], axis=1) == 1
    cut_0fj = ak.num(jet_pt[cut_fj]) == 0
    cut1 = cut_base &amp; cut_1b &amp; cut_0fj

    cut_full_event = cut1
    if IS_DATA:
        mask_lumi = build_lumi_mask('Cert_271036-284044_13TeV_Legacy2016_Collisions16_JSON.txt', events)
        cut_full_event = cut1 &amp; mask_lumi

    # -------------------------------
    # Build output objects
    # -------------------------------
    met = ak.zip(
        {&quot;pt&quot;: met_pt[cut_full_event],
         &quot;eta&quot;: met_eta[cut_full_event],
         &quot;phi&quot;: met_phi[cut_full_event],
         &quot;mass&quot;: 0},
        with_name=&quot;Momentum4D&quot;,
    )

    if channel == &quot;muon&quot;:
        lep = ak.zip(
            {&quot;pt&quot;: muon_pt[cut_full_event][cut_muon[cut_full_event]],
             &quot;eta&quot;: muon_eta[cut_full_event][cut_muon[cut_full_event]],
             &quot;phi&quot;: muon_phi[cut_full_event][cut_muon[cut_full_event]],
             &quot;mass&quot;: muon_mass[cut_full_event][cut_muon[cut_full_event]]},
            with_name=&quot;Momentum4D&quot;,
        )
    else:
        lep = ak.zip(
            {&quot;pt&quot;: electron_pt[cut_full_event][cut_electron[cut_full_event]],
             &quot;eta&quot;: electron_eta[cut_full_event][cut_electron[cut_full_event]],
             &quot;phi&quot;: electron_phi[cut_full_event][cut_electron[cut_full_event]],
             &quot;mass&quot;: electron_mass[cut_full_event][cut_electron[cut_full_event]]},
            with_name=&quot;Momentum4D&quot;,
        )

    # -------------------------------
    # Weights / pileup
    # -------------------------------
    N_gen, gw_pos, gw_neg = -999, -999, -999
    tmpval_events = np.ones(len(ak.flatten(met.pt, axis=None)))
    tmpval = ak.ones_like(ak.flatten(met.pt, axis=None))

    if not IS_DATA:
        gen_weights = events['genWeight'].array()[cut_full_event]
        pileup = events['Pileup_nTrueInt'].array()[cut_full_event]

        if len(gen_weights) != len(tmpval):
            gen_weights = ak.flatten(gen_weights, axis=None)
            pileup = ak.flatten(pileup, axis=None)

        gen_weights_per_candidate = tmpval * gen_weights
        pileup_per_candidate = tmpval * pileup

        gen_weights_org = events['genWeight'].array()
        gw_pos = ak.count(gen_weights_org[gen_weights_org &gt; 0])
        gw_neg = ak.count(gen_weights_org[gen_weights_org &lt; 0])
        N_gen = gw_pos - gw_neg
    else:
        pileup_per_candidate = -999 * tmpval
        gen_weights_per_candidate = -999 * tmpval

    # -------------------------------
    # Save to DataFrame
    # -------------------------------
    mydict = {
        'met_pt': ak.flatten(met.pt, axis=None),
        'lep_pt': ak.flatten(lep.pt, axis=None),
        'pileup': pileup_per_candidate,
        'weight': gen_weights_per_candidate,
        'nevents': nevents * tmpval_events,
        'N_gen': N_gen * tmpval_events,
        'gw_pos': gw_pos * tmpval_events,
        'gw_neg': gw_neg * tmpval_events
    }

    df = pd.DataFrame.from_dict(mydict)
    outfilename = f&quot;OUTPUT_{dataset}_{channel}_{filename.split('/')[-1].split('.')[0]}.csv&quot;
    print(f&quot;Saving output to {outfilename}&quot;)
    df.to_csv(outfilename, index=False)
    return df

</code></pre>
<p>To simplify the selection of the channel, we have created two functions using the <code>process_file</code> function and assigning them a specific channel.</p>
<pre><code class="language-python"># ==========================================================
# Processing function for single-muon channel
# ==========================================================
def process_file_muon(filename, dataset='default', IS_DATA=False):
    return process_file(filename, dataset=dataset, channel=&quot;muon&quot;, IS_DATA=IS_DATA)


# ==========================================================
# Processing function for single-electron channel
# ==========================================================
def process_file_electron(filename, dataset='default', IS_DATA=False):
    return process_file(filename, dataset=dataset, channel=&quot;electron&quot;, IS_DATA=IS_DATA)

</code></pre>
<p>Now we can use these functions to process some data</p>
<pre><code class="language-python">dataset = &quot;ttsemilep&quot;
filenames = get_files_for_dataset(dataset, random=True, n=1)  # por ejemplo
for filename in filenames:
    df = process_file_muon(filename, dataset=dataset, IS_DATA=False)

</code></pre>
<pre><code>Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/120000/301EA765-5A14-1B43-ADED-D3BE6147134B.root

nevents = 905000
Saving output to OUTPUT_ttsemilep_muon_301EA765-5A14-1B43-ADED-D3BE6147134B.csv
</code></pre>
<pre><code class="language-python">dataset = &quot;ttsemilep&quot;
filenames = get_files_for_dataset(dataset, random=True, n=1)  
for filename in filenames:
    df = process_file_electron(filename, dataset=dataset, IS_DATA=False)

</code></pre>
<pre><code>Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/120000/581CBD80-7D60-5E42-9952-B1234440AE4F.root

nevents = 336000
Saving output to OUTPUT_ttsemilep_electron_581CBD80-7D60-5E42-9952-B1234440AE4F.csv
</code></pre>
<pre><code class="language-python">#channel muón
dataset = &quot;collsm&quot;   # SingleMuon data
files = get_files_for_dataset(dataset, random=True, n=1)  

for f in files:
    df_data_mu = process_file_muon(f, dataset=dataset, IS_DATA=True)

</code></pre>
<pre><code>Opening...root://eospublic.cern.ch//eos/opendata/cms/Run2016H/SingleMuon/NANOAOD/UL2016_MiniAODv2_NanoAODv9-v1/70000/01479010-3B51-B04A-9C5C-7800085D11B8.root

nevents = 887639
Saving output to OUTPUT_collsm_muon_01479010-3B51-B04A-9C5C-7800085D11B8.csv
</code></pre>
<pre><code class="language-python">#channel electrón
dataset = &quot;collse&quot;   # SingleElectron data
files = get_files_for_dataset(dataset, random=True, n=1)

for f in files:
    df_data_el = process_file_electron(f, dataset=dataset, IS_DATA=True)

</code></pre>
<pre><code>Opening...root://eospublic.cern.ch//eos/opendata/cms/Run2016H/SingleElectron/NANOAOD/UL2016_MiniAODv2_NanoAODv9-v1/270000/0D3360E0-CCE2-3543-A953-620C362B10C2.root

nevents = 864865
Saving output to OUTPUT_collse_electron_0D3360E0-CCE2-3543-A953-620C362B10C2.csv
</code></pre>
<p>As there are lots of datasets, we are going to add them to a single file.
In order to do that we are going to need a list of <code>datasets</code> and <code>channels</code>.</p>
<pre><code class="language-python">import glob
import os
import pandas as pd

datasets = ['ttsemilep', 'collsm','collse']   # MC and data
channels = ['muon', 'electron']     # both channels

for dataset in datasets:
    for channel in channels:
        path = './'
        all_files = glob.glob(os.path.join(path, f&quot;OUTPUT_{dataset}_{channel}_*.csv&quot;))

        print(f&quot;Found {len(all_files)} files for {dataset} ({channel})&quot;)

        if len(all_files) == 0:
            print(f&quot;No files found for {dataset} ({channel}), skipping.&quot;)
            continue

        dfs = [pd.read_csv(f) for f in all_files]
        df = pd.concat(dfs, ignore_index=True)

        # Recalcular totales
        N_gen = df['N_gen'].iloc[0]
        nevents = df['nevents'].iloc[0]

        df['N_gen'] = N_gen
        df['nevents'] = nevents

        outname = f&quot;SUMMED_{dataset}_{channel}.csv&quot;
        df.to_csv(outname, index=False)
        print(f&quot;Saved {outname}&quot;)

</code></pre>
<pre><code>Found 1 files for ttsemilep (muon)
Saved SUMMED_ttsemilep_muon.csv
Found 1 files for ttsemilep (electron)
Saved SUMMED_ttsemilep_electron.csv
Found 1 files for collsm (muon)
Saved SUMMED_collsm_muon.csv
Found 0 files for collsm (electron)
No files found for collsm (electron), skipping.
Found 0 files for collse (muon)
No files found for collse (muon), skipping.
Found 1 files for collse (electron)
Saved SUMMED_collse_electron.csv
</code></pre>
<p>Now we can access the data and plot it as you can see below</p>
<pre><code class="language-python">import matplotlib.pyplot as plt

df_mu = pd.read_csv(&quot;SUMMED_ttsemilep_muon.csv&quot;)
df_el = pd.read_csv(&quot;SUMMED_ttsemilep_electron.csv&quot;)

plt.hist(df_mu['lep_pt'], bins=30, range=(0,300), histtype=&quot;step&quot;, label=&quot;Muon channel&quot;)
plt.hist(df_el['lep_pt'], bins=30, range=(0,300), histtype=&quot;step&quot;, label=&quot;Electron channel&quot;)
plt.xlabel(&quot;Lepton $p_T$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()
plt.show()

</code></pre>
<p><img alt="png" src="../output_62_0.png" /></p>
<pre><code class="language-python">import matplotlib.pyplot as plt

df_mu = pd.read_csv(&quot;SUMMED_ttsemilep_muon.csv&quot;)
df_el = pd.read_csv(&quot;SUMMED_ttsemilep_electron.csv&quot;)

plt.hist(df_mu['met_pt'], bins=30, range=(0,300), histtype=&quot;step&quot;, label=&quot;Muon channel&quot;)
plt.hist(df_el['met_pt'], bins=30, range=(0,300), histtype=&quot;step&quot;, label=&quot;Electron channel&quot;)
plt.xlabel(&quot;Lepton $met$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()
plt.show()

</code></pre>
<p><img alt="png" src="../output_63_0.png" /></p>
<pre><code class="language-python"># Cargar Data y MC
df_data_mu = pd.read_csv(&quot;SUMMED_collsm_muon.csv&quot;)
df_mc_mu   = pd.read_csv(&quot;SUMMED_ttsemilep_muon.csv&quot;)

df_data_el = pd.read_csv(&quot;SUMMED_collse_electron.csv&quot;)
df_mc_el   = pd.read_csv(&quot;SUMMED_ttsemilep_electron.csv&quot;)
</code></pre>
<pre><code class="language-python"># Shapes normalizados (misma área)
plt.figure(figsize=(12,5))

plt.subplot(1,2,1)
plt.hist(df_mc_mu['lep_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;MC (shape)&quot;)
plt.hist(df_data_mu['lep_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;Data (shape)&quot;)
plt.xlabel(&quot;Muon $p_T$ [GeV]&quot;); plt.ylabel(&quot;Normalized&quot;)
plt.legend()

plt.subplot(1,2,2)
plt.hist(df_mc_el['lep_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;MC (shape)&quot;)
plt.hist(df_data_el['lep_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;Data (shape)&quot;)
plt.xlabel(&quot;Electron $p_T$ [GeV]&quot;); plt.ylabel(&quot;Normalized&quot;)
plt.legend()
plt.tight_layout(); plt.show()

</code></pre>
<p><img alt="png" src="../output_65_0.png" /></p>
<pre><code class="language-python"># Shapes normalizados (misma área)
plt.figure(figsize=(12,5))

plt.subplot(1,2,1)
plt.hist(df_mc_mu['met_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;MC (shape)&quot;)
plt.hist(df_data_mu['met_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;Data (shape)&quot;)
plt.xlabel(&quot;Muon $p_T$ [GeV]&quot;); plt.ylabel(&quot;Normalized&quot;)
plt.legend()

plt.subplot(1,2,2)
plt.hist(df_mc_el['met_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;MC (shape)&quot;)
plt.hist(df_data_el['met_pt'], bins=30, range=(0,300), density=True,
         histtype=&quot;step&quot;, label=&quot;Data (shape)&quot;)
plt.xlabel(&quot;Electron $p_T$ [GeV]&quot;); plt.ylabel(&quot;Normalized&quot;)
plt.legend()
plt.tight_layout(); plt.show()

</code></pre>
<p><img alt="png" src="../output_66_0.png" /></p>
<p>Here we want to get ahead with the normalization, so that we can also compare shapes and see the value of the luminosity, which clearly should go with a dataset. This is just a preliminary step; it will be explained in more detail later because of the normalization.--Ignore</p>
<pre><code class="language-python">import matplotlib.pyplot as plt

# Cargar Data y MC
df_data_mu = pd.read_csv(&quot;SUMMED_collsm_muon.csv&quot;)
df_mc_mu   = pd.read_csv(&quot;SUMMED_ttsemilep_muon.csv&quot;)

df_data_el = pd.read_csv(&quot;SUMMED_collse_electron.csv&quot;)
df_mc_el   = pd.read_csv(&quot;SUMMED_ttsemilep_electron.csv&quot;)

# Parámetros físicos
integrated_luminosity = 60.0  # fb^-1 (ejemplo, dataset pequeño)
xsec_ttsemilep = 831.76     # pb (aprox.)




# Calcular pesos MC
N_gen_mc_mu = df_mc_mu['N_gen'][0]
N_gen_mc_el = df_mc_el['N_gen'][0]

weight_mc_mu = integrated_luminosity * xsec_ttsemilep / N_gen_mc_mu
weight_mc_el = integrated_luminosity * xsec_ttsemilep / N_gen_mc_el

# ========================
# Plots
# ========================

plt.figure(figsize=(12,5))

# Muon channel
plt.subplot(1,2,1)
plt.hist(df_mc_mu['lep_pt'], bins=30, range=(0,300), 
         weights=[weight_mc_mu]*len(df_mc_mu), alpha=0.5, label=&quot;MC ttsemilep&quot;)
plt.hist(df_data_mu['lep_pt'], bins=30, range=(0,300), 
         histtype=&quot;step&quot;, color=&quot;k&quot;, label=&quot;Data (SingleMuon)&quot;)
plt.xlabel(&quot;Muon $p_T$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()

# Electron channel
plt.subplot(1,2,2)
plt.hist(df_mc_el['lep_pt'], bins=30, range=(0,300), 
         weights=[weight_mc_el]*len(df_mc_el), alpha=0.5, label=&quot;MC ttsemilep&quot;)
plt.hist(df_data_el['lep_pt'], bins=30, range=(0,300), 
         histtype=&quot;step&quot;, color=&quot;k&quot;, label=&quot;Data (SingleElectron)&quot;)
plt.xlabel(&quot;Electron $p_T$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()

plt.tight_layout()
plt.savefig(&quot;lep_pt_data_vs_mc.png&quot;)
plt.show()

</code></pre>
<pre><code>/tmp/ipykernel_116/3175142839.py:50: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
</code></pre>
<p><img alt="png" src="../output_68_1.png" /></p>
<pre><code class="language-python">import matplotlib.pyplot as plt

# Cargar Data y MC
df_data_mu = pd.read_csv(&quot;SUMMED_collsm_muon.csv&quot;)
df_mc_mu   = pd.read_csv(&quot;SUMMED_ttsemilep_muon.csv&quot;)

df_data_el = pd.read_csv(&quot;SUMMED_collse_electron.csv&quot;)
df_mc_el   = pd.read_csv(&quot;SUMMED_ttsemilep_electron.csv&quot;)

# Parámetros físicos
integrated_luminosity = 60.0  # pb^-1 (ejemplo, dataset pequeño)
xsec_ttsemilep = 831.76     # pb (aprox.)




# Calcular pesos MC
N_gen_mc_mu = df_mc_mu['N_gen'][0]
N_gen_mc_el = df_mc_el['N_gen'][0]

weight_mc_mu = integrated_luminosity * xsec_ttsemilep / N_gen_mc_mu
weight_mc_el = integrated_luminosity * xsec_ttsemilep / N_gen_mc_el

# ========================
# Plots
# ========================

plt.figure(figsize=(12,5))

# Muon channel
plt.subplot(1,2,1)
plt.hist(df_mc_mu['met_pt'], bins=30, range=(0,300), 
         weights=[weight_mc_mu]*len(df_mc_mu), alpha=0.5, label=&quot;MC ttsemilep&quot;)
plt.hist(df_data_mu['met_pt'], bins=30, range=(0,300), 
         histtype=&quot;step&quot;, color=&quot;k&quot;, label=&quot;Data (SingleMuon)&quot;)
plt.xlabel(&quot;Muon $met$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()

# Electron channel
plt.subplot(1,2,2)
plt.hist(df_mc_el['met_pt'], bins=30, range=(0,300), 
         weights=[weight_mc_el]*len(df_mc_el), alpha=0.5, label=&quot;MC ttsemilep&quot;)
plt.hist(df_data_el['met_pt'], bins=30, range=(0,300), 
         histtype=&quot;step&quot;, color=&quot;k&quot;, label=&quot;Data (SingleElectron)&quot;)
plt.xlabel(&quot;Electron $met$ [GeV]&quot;)
plt.ylabel(&quot;Events&quot;)
plt.legend()

plt.tight_layout()
plt.show()

</code></pre>
<p><img alt="png" src="../output_69_0.png" /></p>
<h1 id="to-process-all-available-data-sets">To process all available data sets</h1>
<h3 id="muon">Muon</h3>
<pre><code class="language-python"># ==========================
# Process all datasets (muon channel)
# ==========================
#datasets = ['collsm', 'ttsemilep', 'ttop', 'ttv', 'Wjets']
datasets = ['ttop', 'ttv', 'Wjets']


for dataset in datasets:
    IS_DATA = dataset.startswith(&quot;coll&quot;)  # True for collision data, False for MC
    filenames = get_files_for_dataset(dataset, random=True, n=1)  # adjust n as needed

    print(f&quot;Processing {len(filenames)} files for {dataset} (muon channel)&quot;)

    for filename in filenames:
        df_mu = process_file_muon(filename, dataset=dataset, IS_DATA=IS_DATA)

</code></pre>
<pre><code>Processing 1 files for ttop (muon channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/2500000/C7DFF052-C1CD-6747-AAD5-73AA56AD82CB.root

nevents = 895000
Saving output to OUTPUT_ttop_muon_C7DFF052-C1CD-6747-AAD5-73AA56AD82CB.csv
Processing 1 files for ttv (muon channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/270000/FD0364C0-B9CF-9C43-ADE8-A950A91D5A8D.root

nevents = 673411
Saving output to OUTPUT_ttv_muon_FD0364C0-B9CF-9C43-ADE8-A950A91D5A8D.csv
Processing 1 files for Wjets (muon channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/280000/216B70A2-8211-2B4E-8B82-F3CB8F097641.root

nevents = 197244
Saving output to OUTPUT_Wjets_muon_216B70A2-8211-2B4E-8B82-F3CB8F097641.csv
</code></pre>
<h3 id="electron">Electron</h3>
<pre><code class="language-python"># ==========================
# Process all datasets (electron channel)
# ==========================
#datasets = ['collse', 'ttsemilep', 'ttop', 'ttv', 'Wjets']
datasets = ['ttop', 'ttv', 'Wjets']


for dataset in datasets:
    IS_DATA = dataset.startswith(&quot;coll&quot;)
    filenames = get_files_for_dataset(dataset, random=True, n=1)

    print(f&quot; Processing {len(filenames)} files for {dataset} (electron channel)&quot;)

    for filename in filenames:
        df_el = process_file_electron(filename, dataset=dataset, IS_DATA=IS_DATA)

</code></pre>
<pre><code> Processing 1 files for ttop (electron channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/ST_t-channel_top_4f_InclusiveDecays_TuneCP5CR2_13TeV-powheg-madspin-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/2500000/46E58BC2-6B38-1845-BE51-0C65F7D8CDB6.root

nevents = 1241000
Saving output to OUTPUT_ttop_electron_46E58BC2-6B38-1845-BE51-0C65F7D8CDB6.csv
 Processing 1 files for ttv (electron channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/130000/C6039E7C-9B89-F84E-A1BE-309DD4A34153.root

nevents = 272723
Saving output to OUTPUT_ttv_electron_C6039E7C-9B89-F84E-A1BE-309DD4A34153.csv
 Processing 1 files for Wjets (electron channel)
Opening...root://eospublic.cern.ch//eos/opendata/cms/mc/RunIISummer20UL16NanoAODv9/WJetsToLNu_HT-400To600_TuneCP5_13TeV-madgraphMLM-pythia8/NANOAODSIM/106X_mcRun2_asymptotic_v17-v1/120000/30407250-6834-4642-AD3A-0AB0D1F9E639.root

nevents = 41364
Saving output to OUTPUT_Wjets_electron_30407250-6834-4642-AD3A-0AB0D1F9E639.csv
</code></pre>
<h3 id="uniting-the-two">Uniting the two</h3>
<pre><code class="language-python">import glob
import os
import pandas as pd

datasets = ['collse', 'collsm', 'ttsemilep', 'ttop', 'ttv', 'Wjets']
channels = ['muon', 'electron']   # ensure we split per channel

for dataset in datasets:
    for channel in channels:
        N_gen = 0
        nevents = 0
        gw_pos = 0
        gw_neg = 0
        IS_COLLISION = dataset.startswith(&quot;coll&quot;)

        path = './'
        all_files = glob.glob(os.path.join(path, f&quot;OUTPUT_{dataset}_{channel}_*.csv&quot;))

        print(f&quot;🔎 Processing {len(all_files)} files in {dataset} ({channel})&quot;)

        if len(all_files) == 0:
            print(f&quot;⚠️No files found for {dataset} ({channel}), skipping.&quot;)
            continue

        list_of_dataframes = []

        for filename in all_files:
            df = pd.read_csv(filename, index_col=None, header=0)
            list_of_dataframes.append(df)

            if len(df) &gt; 0:
                N_gen += df['N_gen'][0]
                nevents += df['nevents'][0]
                gw_pos += df['gw_pos'][0]
                gw_neg += df['gw_neg'][0]

        # For real collision data we don’t use MC weights
        if IS_COLLISION:
            N_gen = -999
            gw_pos = -999
            gw_neg = -999

        df = pd.concat(list_of_dataframes, axis=0, ignore_index=True)
        df['N_gen'] = N_gen
        df['nevents'] = nevents
        df['gw_pos'] = gw_pos
        df['gw_neg'] = gw_neg

        outname = f&quot;SUMMED_{dataset}_{channel}.csv&quot;
        df.to_csv(outname, index=False)
        print(f&quot;✅ Saved {outname}&quot;)

</code></pre>
<pre><code>🔎 Processing 0 files in collse (muon)
⚠️No files found for collse (muon), skipping.
🔎 Processing 1 files in collse (electron)
✅ Saved SUMMED_collse_electron.csv
🔎 Processing 1 files in collsm (muon)
✅ Saved SUMMED_collsm_muon.csv
🔎 Processing 0 files in collsm (electron)
⚠️No files found for collsm (electron), skipping.
🔎 Processing 1 files in ttsemilep (muon)
✅ Saved SUMMED_ttsemilep_muon.csv
🔎 Processing 1 files in ttsemilep (electron)
✅ Saved SUMMED_ttsemilep_electron.csv
🔎 Processing 1 files in ttop (muon)
✅ Saved SUMMED_ttop_muon.csv
🔎 Processing 1 files in ttop (electron)
✅ Saved SUMMED_ttop_electron.csv
🔎 Processing 1 files in ttv (muon)
✅ Saved SUMMED_ttv_muon.csv
🔎 Processing 1 files in ttv (electron)
✅ Saved SUMMED_ttv_electron.csv
🔎 Processing 1 files in Wjets (muon)
✅ Saved SUMMED_Wjets_muon.csv
🔎 Processing 1 files in Wjets (electron)
✅ Saved SUMMED_Wjets_electron.csv
</code></pre>
<h2 id="why-normalization-is-necessary">Why Normalization is Necessary</h2>
<p>When comparing <strong>data</strong> and <strong>Monte Carlo (MC) simulations</strong>, the raw event counts are not directly comparable:</p>
<ul>
<li><strong>Data</strong>:  </li>
<li>Events are collected with a detector during a given time period.  </li>
<li>The "size" of the dataset is controlled by the <strong>integrated luminosity</strong> (<em>L</em>).  </li>
<li>Example: UL2016 SingleMuon dataset corresponds to ~35.9 fb⁻¹.  </li>
<li>
<p>There is <strong>no cross section</strong> attached — it is just what was recorded.</p>
</li>
<li>
<p><strong>MC (simulations)</strong>:  </p>
</li>
<li>Each simulated dataset corresponds to a particular physics process (e.g. <em>t t̄</em>, W+jets).  </li>
<li>Generators simulate a finite number of events (<em>N</em>₍gen₎) with a known theoretical <strong>cross section</strong> (<em>σ</em>).  </li>
<li>By construction, MC samples may represent more or fewer events than what would be seen in real data.  </li>
<li>Therefore, they must be <strong>scaled</strong>.</li>
</ul>
<h3 id="the-normalization-formula">The Normalization Formula</h3>
<p>To make MC comparable to data, we apply a <strong>per-event weight</strong>:</p>
<div class="arithmatex">\[
w = \frac{\sigma \cdot L}{N_\text{gen}}
\]</div>
<p>Where:<br />
- <strong>σ (pb)</strong> = process cross section (from theory/measurements).<br />
- <strong>L (fb⁻¹)</strong> = integrated luminosity of the data sample.<br />
  - Convert to <strong>pb⁻¹</strong> by multiplying by 1000.<br />
- <strong>N</strong>₍gen₎ = total number of generated MC events (before cuts).  </p>
<p>This weight ensures that when we sum the MC events after applying cuts, the histograms reflect the <strong>expected yield</strong> in the same luminosity as the data.</p>
<h3 id="why-it-matters">Why it Matters</h3>
<ul>
<li>Without normalization, MC histograms are <strong>arbitrary</strong> and cannot be compared to data.  </li>
<li>After normalization, MC yields represent the <strong>expected number of events</strong> under the Standard Model.  </li>
<li>This allows us to:  </li>
<li>Compare data vs MC in control regions.  </li>
<li>Estimate backgrounds in signal regions.  </li>
<li>Search for discrepancies that may indicate new physics (e.g. Dark Matter).  </li>
</ul>
<h4 id="define-cross-sections">Define Cross-Sections</h4>
<p>For each simulated process (MC), we need the theoretical cross section (σ) in pb.<br />
This will later be combined with the luminosity (L) and the number of generated events (N_gen) to normalize MC histograms.</p>
<ul>
<li>Data samples (SingleMuon, MET, …) have <strong>no cross section</strong>.  </li>
<li>MC samples (ttbar, W+jets, dibosons, …) each get a σ value.  </li>
</ul>
<p>Below is a table of cross-sections (UL2016, approximate values).</p>
<pre><code class="language-python">
import pandas as pd

integrated_luminosity = 60.0  # * 1000.0  # convert fb^-1 to pb^-1 and nd we have no idea of the value of this

xsecs = {
    &quot;Wjets&quot;: 45.21,
    &quot;ttsemilep&quot;: 831.76,
    &quot;ttv&quot;: 0.2151,
    &quot;ttop&quot;: 113.4,
}

datasets = ['collse', 'collsm', 'ttsemilep', 'ttop', 'ttv', 'Wjets']
channels = ['muon', 'electron']

# Diccionario para guardar los pesos
weights = {}

print(&quot;\n=== Weights per dataset/channel ===&quot;)
for dataset in datasets:
    for channel in channels:
        try:
            df = pd.read_csv(f&quot;SUMMED_{dataset}_{channel}.csv&quot;)
        except FileNotFoundError:
            continue

        N_gen = df['N_gen'][0]

        if dataset.startswith(&quot;coll&quot;):
            weight = 1.0
        elif dataset in xsecs:
            xsec = xsecs[dataset]
            weight = integrated_luminosity * xsec / N_gen 
        else:
            print(f&quot;No xsec for {dataset}, skipping...&quot;)
            continue

        key = f&quot;{dataset}_{channel}&quot;
        weights[key] = weight
        print(f&quot;{key:20s}  weight = {weight:.4f}&quot;)
</code></pre>
<pre><code>=== Weights per dataset/channel ===
collse_electron       weight = 1.0000
collsm_muon           weight = 1.0000
ttsemilep_muon        weight = 0.0556
ttsemilep_electron    weight = 0.1498
ttop_muon             weight = 0.0081
ttop_electron         weight = 0.0059
ttv_muon              weight = 0.0000
ttv_electron          weight = 0.0001
Wjets_muon            weight = 0.0138
Wjets_electron        weight = 0.0656
</code></pre>
<pre><code class="language-python"># ================== CMS STYLE CONFIG ==================
import matplotlib.pyplot as plt
import mplhep as hep

# Use CMS style from mplhep
plt.style.use(hep.style.CMS)

# ---- global style tweaks ----
plt.rcParams.update({
    &quot;axes.titlesize&quot;: 10,
    &quot;axes.labelsize&quot;: 10,
    &quot;xtick.labelsize&quot;: 10,
    &quot;ytick.labelsize&quot;: 10,
    &quot;legend.fontsize&quot;: 10,
    &quot;figure.constrained_layout.use&quot;: True,  # avoid tight_layout warning
})




</code></pre>
<pre><code class="language-python">from hist import Hist
import pandas as pd
import matplotlib.pyplot as plt
import mplhep as hep
import numpy as np

# Build histogram for muon channel
h_mu = (
    Hist.new.Reg(20, 0, 500, name=&quot;met_pt&quot;, label=r&quot;$p_T^{miss}$ [GeV]&quot;)
        .StrCat([], name=&quot;dataset&quot;, label=&quot;dataset&quot;, growth=True)
        .Weight()
)

datasets_muon = [&quot;collsm&quot;, &quot;ttsemilep&quot;, &quot;ttop&quot;, &quot;ttv&quot;, &quot;Wjets&quot;]
collision_muon = [&quot;collsm&quot;]
background_muon = [&quot;ttsemilep&quot;, &quot;ttop&quot;, &quot;ttv&quot;, &quot;Wjets&quot;]

for dataset in datasets_muon:
    try:
        df = pd.read_csv(f&quot;SUMMED_{dataset}_muon.csv&quot;)
    except FileNotFoundError:
        print(f&quot;Missing file SUMMED_{dataset}_muon.csv, skipping&quot;)
        continue

    vals = df[&quot;met_pt&quot;].values
    key = f&quot;{dataset}_muon&quot;


    weight = weights[key]
    h_mu.fill(met_pt=vals, dataset=dataset, weight=weight)

# ---------- Plot ----------
fig, (ax, rax) = plt.subplots(
    2, 1, gridspec_kw=dict(height_ratios=[3, 1], hspace=0.05),
    sharex=True, figsize=(7, 6)
)

hep.cms.label(&quot;Open Data&quot;, ax=ax, data=True, lumi=0.169, year=2016, fontsize=12)

# Stack MC
h_mu[:, background_muon].stack(&quot;dataset&quot;)[:].project(&quot;met_pt&quot;).plot(
    ax=ax, stack=True, histtype=&quot;fill&quot;
)

# Overlay Data
h_mu[:, collision_muon].project(&quot;met_pt&quot;).plot(
    ax=ax, histtype=&quot;errorbar&quot;, color=&quot;k&quot;, markersize=6, label=&quot;Data&quot;
)

ax.set_ylabel(&quot;Events&quot;)
ax.set_title(&quot;Single-Muon channel&quot;)
ax.legend()

# ---------- Ratio plot ----------
Hdata = h_mu[:, collision_muon].project(&quot;met_pt&quot;)
Hmc   = h_mu[:, background_muon].project(&quot;met_pt&quot;)

centers = 0.5 * (Hdata.axes[0].edges[:-1] + Hdata.axes[0].edges[1:])
data_vals = Hdata.values()
mc_vals   = Hmc.values()

ratio = np.divide(data_vals, mc_vals, out=np.zeros_like(data_vals, dtype=float), where=mc_vals &gt; 0)
err   = np.divide(np.sqrt(data_vals), mc_vals, out=np.zeros_like(data_vals, dtype=float), where=mc_vals &gt; 0)

rax.errorbar(centers, ratio, yerr=err, fmt=&quot;o&quot;, color=&quot;k&quot;)
rax.axhline(1.0, ls=&quot;--&quot;, color=&quot;k&quot;)
rax.set_ylabel(&quot;Data/MC&quot;)
rax.set_xlabel(r&quot;$p_T^{miss}$ [GeV]&quot;)
rax.set_ylim(0.5, 1.5)
ax.set_xlim(0, 300)
rax.set_xlim(0, 300)

plt.show()
</code></pre>
<pre><code>/usr/local/venv/lib/python3.10/site-packages/hist/basehist.py:480: UserWarning: List indexing selection is experimental. Removed bins are not placed in overflow.
  return super().__getitem__(self._index_transform(index))
/usr/local/venv/lib/python3.10/site-packages/hist/basehist.py:480: UserWarning: List indexing selection is experimental. Removed bins are not placed in overflow.
  return super().__getitem__(self._index_transform(index))
</code></pre>
<p><img alt="png" src="../output_80_1.png" /></p>
<pre><code class="language-python"># Build histogram for electron channel
h_el = (
    Hist.new.Reg(20, 0, 500, name=&quot;met_pt&quot;, label=r&quot;$p_T^{miss}$ [GeV]&quot;)
        .StrCat([], name=&quot;dataset&quot;, label=&quot;dataset&quot;, growth=True)
        .Weight()
)

datasets_electron = [&quot;collse&quot;, &quot;ttsemilep&quot;, &quot;ttop&quot;, &quot;ttv&quot;, &quot;Wjets&quot;]
collision_electron = [&quot;collse&quot;]
background_electron = [&quot;ttsemilep&quot;, &quot;ttop&quot;, &quot;ttv&quot;, &quot;Wjets&quot;]

for dataset in datasets_electron:
    try:
        df = pd.read_csv(f&quot;SUMMED_{dataset}_electron.csv&quot;)
    except FileNotFoundError:
        print(f&quot;Missing file SUMMED_{dataset}_electron.csv, skipping&quot;)
        continue

    vals = df[&quot;met_pt&quot;].values
    key = f&quot;{dataset}_electron&quot;

    weight = weights[key]
    h_el.fill(met_pt=vals, dataset=dataset, weight=weight)

# ---------- Plot ----------
fig, (ax, rax) = plt.subplots(
    2, 1, gridspec_kw=dict(height_ratios=[3, 1], hspace=0.05),
    sharex=True, figsize=(7, 6)
)

hep.cms.label(
    &quot;Open Data&quot;,
    ax=ax,
    data=True,
    lumi=0.169,
    year=2016,
    fontsize=12
)

# Stack MC
h_el[:, background_electron].stack(&quot;dataset&quot;)[:].project(&quot;met_pt&quot;).plot(
    ax=ax, stack=True, histtype=&quot;fill&quot;
)

# Overlay Data
h_el[:, collision_electron].project(&quot;met_pt&quot;).plot(
    ax=ax, histtype=&quot;errorbar&quot;, color=&quot;k&quot;, markersize=6, label=&quot;Data&quot;
)

ax.set_ylabel(&quot;Events&quot;)
ax.set_title(&quot;Single-Electron channel&quot;)
ax.legend()

# ---------- Ratio plot ----------
Hdata = h_el[:, collision_electron].project(&quot;met_pt&quot;)
Hmc   = h_el[:, background_electron].project(&quot;met_pt&quot;)

centers = 0.5 * (Hdata.axes[0].edges[:-1] + Hdata.axes[0].edges[1:])
data_vals = Hdata.values()
mc_vals   = Hmc.values()

ratio = np.divide(data_vals, mc_vals, out=np.zeros_like(data_vals, dtype=float), where=mc_vals &gt; 0)
err   = np.divide(np.sqrt(data_vals), mc_vals, out=np.zeros_like(data_vals, dtype=float), where=mc_vals &gt; 0)

rax.errorbar(centers, ratio, yerr=err, fmt=&quot;o&quot;, color=&quot;k&quot;)
rax.axhline(1.0, ls=&quot;--&quot;, color=&quot;k&quot;)
rax.set_ylabel(&quot;Data/MC&quot;)
rax.set_xlabel(r&quot;$p_T^{miss}$ [GeV]&quot;)
rax.set_ylim(0.5, 1.5)
ax.set_xlim(0, 300)
rax.set_xlim(0, 300)

plt.show()
</code></pre>
<pre><code>/usr/local/venv/lib/python3.10/site-packages/hist/basehist.py:480: UserWarning: List indexing selection is experimental. Removed bins are not placed in overflow.
  return super().__getitem__(self._index_transform(index))
/usr/local/venv/lib/python3.10/site-packages/hist/basehist.py:480: UserWarning: List indexing selection is experimental. Removed bins are not placed in overflow.
  return super().__getitem__(self._index_transform(index))
</code></pre>
<p><img alt="png" src="../output_81_1.png" /></p>
<pre><code class="language-python">
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../All_Hadronic/all%20hadronic%20si/" class="md-footer__link md-footer__link--prev" aria-label="Previous: All hadronic chanel">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                All hadronic chanel
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>